#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrbook
\begin_preamble
\usepackage{multicol}
\usepackage{tocbibind}
%\usepackage[scaled=.85]{couriers}

\usepackage[font=it]{caption}
\usepackage{indentfirst}
\usepackage{textcomp}
\usepackage{placeins}

% Label subsections
\newrefformat{subsec}{Subsection \ref{#1}}

% Following to get bold-face typewriter font in LyXCode
\renewenvironment{lyxcode}
  {\begin{list}{}{
    \setlength{\rightmargin}{\leftmargin}
    \raggedright
    \setlength{\itemsep}{0pt}
    \setlength{\parsep}{0pt}
    \normalfont\bfseries\ttfamily}%
    \item[]}
  {\end{list}}

\addtokomafont{labelinglabel}{\texttt}
\end_preamble
\options sort&compress
\use_default_options false
\maintain_unincluded_children false
\language american
\language_package default
\inputencoding iso8859-1
\fontencoding global
\font_roman "times" "default"
\font_sans "helvet" "default"
\font_typewriter "courier" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 90 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 0
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue,citecolor=blue,urlcolor=blue"
\papersize letterpaper
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 0
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type numerical
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch advanced
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\branch basic
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\paperwidth 6in
\paperheight 9in
\leftmargin 1.2in
\topmargin 1in
\rightmargin 1in
\bottommargin 1.2in
\secnumdepth 3
\tocdepth 1
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\listings_params "basicstyle={\small\bfseries\ttfamily},frame=single,frameround=tttt,upquote=true"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\align center

\series bold
\size giant
nabc/sff 
\end_layout

\begin_layout Standard
\align center

\size huge
\emph on
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Chapter
\begin_inset CommandInset label
LatexCommand label
name "cha:NAB"

\end_inset


\series bold
NAB and libsff
\end_layout

\begin_layout Section
A little history
\end_layout

\begin_layout Standard
The NAB language compiler 
\emph on
nab2c
\emph default
 (which converts NAB source code to C, for subsequent compilation) was written
 in the 1990's by Tom Macke.
 The original design idea was to create a 
\begin_inset Quotes eld
\end_inset

molecular awk
\begin_inset Quotes erd
\end_inset

: a scripting language for manipulation of (macro-)molecules that would
 be primarily used to create short scripts to carry out molecular manipulations.
 It was quickly realized that manipulations like force field minimization
 would be useful, and the Amber-compatible molecular mechanics routines
 were added by David Case as 
\emph on
sff
\emph default
, a 
\begin_inset Quotes eld
\end_inset

simple force field
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Over the years, 
\emph on
sff
\emph default
 evolved to keep pace with (and in many cases drive) Amber developments
 involving implicit force fields, including generalized Born, Poisson-Boltzmann
 and RISM approaches.
 In keeping with its original motivation, 
\emph on
sff
\emph default
 concentrated on implicit solvation, leaving explicit solvent and periodic
 simulations to the main Amber programs 
\emph on
sander
\emph default
 and 
\emph on
pmemd
\emph default
.
 The 
\emph on
sff
\emph default
 routines were parallelized using both openmp and MPI, and second derivatives
 of the generalized Born model were added by Russ Brown.
\begin_inset CommandInset citation
LatexCommand citep
key "Brown06"
literal "true"

\end_inset

 Apart from the lack of a GPU implementation, the routines in 
\emph on
sff
\emph default
 are the most general and efficient ones in the Amber package.
 In particular, 
\emph on
sff
\emph default
 excels at generalized Born simulations on large systems, benefitting from
 an advanced nonbonded list builder, and from the hierarchical charge partition
 model described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hcp"

\end_inset

.
\end_layout

\begin_layout Standard
As a first step, we have prepared sample files in 
\family typewriter
$AMBERHOME/AmberTools/test/nabc
\family default
, which illustrate how to use most of the 
\emph on
sff
\emph default
 functionality directly from a stand-alone C driver.
 The 
\emph on
Makefile
\emph default
 in this directory can guide you through running several sample calculations.
 Looking at the code, and its comments, along with the header file (
\family typewriter
$AMBERHOME/include/sff.h
\family default
) should go a long way towards allowing direct integration into C codes,
 without any reference to the NAB compiler.
 The rest of this chapter has documentation for 
\emph on
libsff
\emph default
.
\end_layout

\begin_layout Section

\series bold
Basic molecular mechanics routines
\begin_inset CommandInset label
LatexCommand label
name "sec:NAB-Basic-molecular-mechanics"

\end_inset


\end_layout

\begin_layout LyX-Code

\family sans
int readparm
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
readparm
\end_layout

\end_inset

( molecule m, string parmfile );
\end_layout

\begin_layout LyX-Code

\family sans
int mme_init
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
mme
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

init
\end_layout

\end_inset

( molecule mol, string aexp, string aexp2, point xyz_ref[], string filename
 );
\end_layout

\begin_layout LyX-Code

\family sans
int mm_options
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
mm
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

options
\end_layout

\end_inset

( string opts );
\end_layout

\begin_layout LyX-Code

\family sans
float mme
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
mme
\end_layout

\end_inset

( point xyz[], point grad[], int iter );
\end_layout

\begin_layout LyX-Code

\family sans
float mme_rattle
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
mme
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

rattle
\end_layout

\end_inset

( point xyz[], point grad[], int iter );
\end_layout

\begin_layout LyX-Code

\family sans
int conjgrad
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
conjgrad
\end_layout

\end_inset

( float x[], int n, float fret, float func(), float rmsgrad, 
\begin_inset Newline newline
\end_inset

           float dfpred, int maxiter );
\end_layout

\begin_layout LyX-Code

\family sans
int md
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
md
\end_layout

\end_inset

( int n, int maxstep, point xyz[], point f[], float v[], float func );
\end_layout

\begin_layout LyX-Code

\family sans
int getxv
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
getxv
\end_layout

\end_inset

( string filename, int natom, float start_time, float x[], float v[] );
\end_layout

\begin_layout LyX-Code

\family sans
int putxv
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
putxv
\end_layout

\end_inset

( string filename, string title, int natom, float start_time, 
\begin_inset Newline newline
\end_inset

           float x[], float v[] );
\end_layout

\begin_layout LyX-Code

\family sans
void mm_set_checkpoint
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
mm
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

set
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

checkpoint
\end_layout

\end_inset

( string filename );
\end_layout

\begin_layout Standard

\family sans
readparm
\family default
 reads an AMBER parameter-topology file, created by 
\family sans
tleap
\family default
 or with other AMBER programs, and sets up a data structure which we call
 a "parmstruct".
 This is part of the molecule, but is not directly accessible (yet) to 
\family sans
nab
\family default
 programs.
 You would use this command as an alternative to
\family sans
 getpdb_prm()
\family default
.
 You need to be sure that the molecule used in the 
\family sans
readparm()
\family default
 call has been created by calling 
\family sans
getpdb()
\family default
 with a PDB file that has been created by tleap itself (i.e., that has exactly
 the Amber atoms in the correct order).
 As noted above, the 
\family sans
readparm()
\family default
 routine is primarily intended for cases where 
\family sans
getpdb_prm()
\family default
 fails (i.e., when you need to run 
\shape italic
tleap
\shape default
 by hand).
\end_layout

\begin_layout Standard

\family sans
setxyz_from_mol()
\family default
 copies the atomic coordinates of 
\family sans
mol
\family default
 to the array 
\family sans
xyz
\family default
.
 
\family sans
setmol_from_xyz()
\family default
 replaces the atomic coordinates of 
\family sans
mol
\family default
 with the contents of 
\family sans
xyz
\family default
.
 Both return the number of atoms copied with a 
\family sans
0
\family default
 indicating an error occurred.
\end_layout

\begin_layout Standard
The 
\family sans
getxv()
\family default
 and 
\family sans
putxv()
\family default
 routines read and write non-periodic Amber-style restart files.
 Velocities are read if present.
 
\end_layout

\begin_layout Standard
The 
\family sans
getxyz()
\family default
 and 
\family sans
putxyz()
\family default
 routines are used in conjunction with the 
\family sans
mm_set_checkpoint()
\family default
 routine to write checkpoint or restart files.
 The coordinates are written at higher precision than to an AMBER restart
 file, i.e., with sufficiently high precision to restart even a Newton-Raphson
 minimization where the error in coordinates may be on the order of
\begin_inset Formula $10^{-12}$
\end_inset

 .
 The checkpoint files are written at iteration intervals that are specified
 by the 
\shape italic
nchk
\shape default
 or 
\shape italic
nchk2
\shape default
 parameters to the 
\family sans
mm_options()
\family default
 routine (see below).
 The checkpoint file names are determined by the filename string that is
 passed to 
\family sans
mm_set_checkpoint()
\family default
.
 If filename contains one or more %d format specifiers, then the file name
 will be a modification of filename wherein the leftmost %d of filename
 is replaced by the iteration count.
 If filename contains no %d format specifier, then the file name will be
 filename with the iteration count appended on the right.
\end_layout

\begin_layout Standard
The 
\family sans
mme_init()
\family default
 function must be called after 
\family sans
mm_options()
\family default
 and before calls to 
\family sans
mme().

\family default
 It sets up parameters for future force field evaluations, and takes as
 input an 
\family sans
nab
\family default
 molecule.
 The string 
\family sans
aexp
\family default
 is an atom expression that indicates which atoms are to be allowed to move
 in minimization or dynamics: atoms that do not match 
\family sans
aexp
\family default
 will have their positions in the gradient vector set to zero.
 A 
\family sans
NULL
\family default
 atom expression will allow all atoms to move.
 The second string, 
\family sans
aexp2
\family default
 identifies atoms whose positions are to be restrained to the positions
 in the array 
\family sans
xyz_ref
\family default
.
 The strength of this restraint will be given by the 
\family sans
wcons
\family default
 variable set in 
\family sans
mm_options()
\family default
.
 A 
\family sans
NULL
\family default
 value for 
\family sans
aexp2
\family default
 will cause all atoms to be constrained.
 The last parameter to 
\family sans
mme_init()
\family default
 is a file name without extension for the output trajectory file.
 This should be NULL if no output file is desired.
 NAB writes trajectories in the 
\emph on
netCDF
\emph default
 format, which can be read by 
\emph on
cpptraj
\emph default
, and either analyzed, or converted to another format.
 The default netCDF extension of .nc is automatically added to the file name.
\end_layout

\begin_layout Standard

\family sans
mm_options()
\family default
 is used to set parameters
\family sans
, and
\family default
 must be called before 
\family sans
mme_init()
\family default
; if you change options through a call to 
\family sans
mm_options()
\family default
 without a subsequent call to 
\family sans
mme_init()
\family default
 you may get incorrect calculations with no error messages.
 Beware.
 The 
\family sans
opts
\family default
 string contains keyword/value pairs of the form 
\family sans
keyword=value
\family default
 separated by white space or commas.
 Allowed values are shown in the following table.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="122" columns="3">
<features islongtable="true" headBottomDL="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="3.5in">
<row endhead="true">
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
keyword 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
meaning
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ntpr
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ntpr
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency of printing of the energy and its components.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
e_debug
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
e
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

debug
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If nonzero printout additional components of the energy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gb_debug
\family default
 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
gb
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

debug 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If nonzero printout information about Born first derivatives.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gb2_debug
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
gb2
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

debug
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If nonzero printout information about Born second derivatives.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nchk
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nchk
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency of writing checkpoint file during first derivative calculation,
 i.e., in the mme() routine.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nchk2
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nchk2
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency of writing checkpoint file during second derivative calculation,
 i.e., in the mme2() routine.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nsnb
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nsnb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency at which the non-bonded list is updated.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ns
\family default
cm
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nscm
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If > 0, remove translational and rotational center-of-mass (COM) motion
 after every nscm steps.
 For Langevin dynamics (gamma_ln>0) without HCP (hcp=0), the position of
 the COM is reset to zero every nscm steps, but the velocities are not affected.
 With HCP (hcp>0) COM translation and rotation are also removed, with or
 without Langevin dynamics.
\end_layout

\begin_layout Plain Layout
It is strongly recommended that this option be used whenever HCP is used.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
cut
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
cut
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non-bonded cutoff, in angstroms.
 This parameter is ignored if hcp > 0.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
wcons
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
wcons
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Restraint weight for keeping atoms close to their positions in 
\family sans
xyz_ref
\family default
 (see 
\shape italic
mme_init
\shape default
).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
dim
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
dim
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of spatial dimensions; supported values are 3 and 4.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
k4d
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
k4d
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Force constant for squeezing out the fourth dimensional coordinate, if dim=4.
 If this is nonzero, a penalty function will be added to the bounds-violation
 energy, which is equal to 0.5 * 
\shape italic
k4d * w * w
\shape default
, where 
\begin_inset Formula $w$
\end_inset

 is the value of the fourth dimensional coordinate.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dt
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Time step, ps.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
t
\family default
 
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
t 
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Initial time, ps.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
rattle
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
rattle
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If set to 1, bond lengths will be constrained to their equilibrium values,
 for dynamics; if set to 2, bonds to hydrogens will be constrained; default
 is not to include such constraints.
 Note: if you want to use rattle (effectively "shake") for minimization,
 you do not need to set this parameter; rather, pass the 
\family sans
mme_rattle()
\family default
 function to 
\shape italic
conjgrad()
\shape default
.

\family sans
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
tautp
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
tautp
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
999999.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Temperature coupling parameter, in ps.
 The time constant determines the strength of the weak-coupling ("Berendsen")
 temperature bath.
\begin_inset CommandInset citation
LatexCommand cite
key "Berendsen84"
literal "true"

\end_inset

 Set 
\shape italic
tautp
\shape default
 to a very large value (e.g.
 9999999.) in order to turn off coupling and revert to Newtonian dynamics.
 This variable only has an effect if 
\shape italic
gamma_ln
\shape default
 remains at its default value of zero; if 
\shape italic
gamma_ln
\shape default
 is not zero, Langevin dynamics is assumed, as discussed below.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gamma_ln
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
gamma
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

ln
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Collision frequency for Langevin dynamics, in
\begin_inset Formula $ps^{-1}$
\end_inset

 .
 Values in the range 2-5
\begin_inset Formula $ps^{-1}$
\end_inset

 often give acceptable temperature control, while allowing transitions to
 take place.
\begin_inset CommandInset citation
LatexCommand cite
key "Loncharich92"
literal "true"

\end_inset

 Values near 50
\begin_inset Formula $ps^{-1}$
\end_inset

 correspond to the collision frequency for liquid water, and may be useful
 if rough physical time scales for motion are desired.
 The so-called BBK integrator is used here.
\begin_inset CommandInset citation
LatexCommand cite
key "Brooks85"
literal "true"

\end_inset


\family sans
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
temp0
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
temp0
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
300.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Target temperature, K.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
vlimit
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
vlimit
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum absolute value of any component of the velocity vector.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ntpr_md
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ntpr
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
_
\end_layout

\end_inset

md
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Printing frequency for dynamics information to stdout.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ntwx
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ntwx
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Frequency for dumping coordinates to traj_file.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
zerov
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
zerov
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If nonzero, then the initial velocities will be set to zero.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
tempi
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
tempi
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If 
\shape italic
zerov
\shape default
=0 and 
\shape italic
tempi
\shape default

\begin_inset Formula $>$
\end_inset

0, then the initial velocities will be randomly chosen for this temperature.
 If both 
\shape italic
zerov
\shape default
 and 
\shape italic
tempi
\shape default
 are zero, the velocities passed into the md() function will be used as
 the initial velocities; this combination is useful to continue an existing
 trajectory.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
genmass
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
genmass
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The general mass to use for MD if individual masses are not read from a
 prmtop file; value in amu.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
diel
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
diel
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Code for the dielectric model.
 "C" gives a dielectric constant of 1; "R" makes the dielectric constant
 equal to distance in angstroms; "RL" uses the sigmoidal function of Ramstein
 & Lavery, PNAS 
\series bold
85
\series default
, 7231 (1988); "RL94" is the same thing, but speeded up assuming one is
 using the Cornell 
\shape italic
et al
\shape default
 force field; "R94" is a distance-dependent dielectric, again with speedups
 that assume the Cornell 
\shape italic
et al.

\shape default
 force field.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
dielc
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
dielc
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
This is the dielectric constant used for 
\shape italic
non-GB
\shape default
 simulations.
 It is implemented in routine 
\family sans
mme_init()
\family default
 by scaling all of the charges by 
\family sans
sqrt(dielc)
\family default
.
 This means that you need to set this (if desired) in 
\family sans
mm_options()
\family default
 before calling 
\family sans
mme_init()
\family default
.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gb
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
gb
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "nab_gb"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If set to 0 then GB is off.
 Setting gb=1 turns on the Hawkins, Cramer, Truhlar (HCT) form of pairwise
 generalized Born model for solvation.
 See ref 
\begin_inset CommandInset citation
LatexCommand cite
key "Tsui01"
literal "true"

\end_inset

 for details of the implementation; this is equivalent to the 
\shape italic
igb=1
\shape default
 option in 
\emph on
sander
\emph default
 and 
\emph on
pmemd
\emph default
.
 Set diel to "C" if you use this option.
 Setting gb=2 turns on the Onufriev, Bashford, Case (OBC) variant of GB,
\begin_inset CommandInset citation
LatexCommand cite
key "Onufriev00,Onufriev04"
literal "true"

\end_inset

 with 
\begin_inset Formula $\alpha$
\end_inset

=0.8, 
\begin_inset Formula $\beta$
\end_inset

=0.0 and 
\begin_inset Formula $\gamma$
\end_inset

=2.909.
 This is equivalent to the 
\shape italic
igb=2
\shape default
 option in 
\emph on
sander
\emph default
 and 
\emph on
pmemd
\emph default
.
 Setting gb=5 just changes the values of 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $\beta$
\end_inset

 and 
\begin_inset Formula $\gamma$
\end_inset

 to 1.0, 0.8, and 4.85, respectively, corresponding to the 
\shape italic
igb=5
\shape default
 option in 
\emph on
sander
\emph default
.
 Setting gb=7 turns on the GB Neck variant of GB,
\begin_inset CommandInset citation
LatexCommand citep
key "Mongan07"
literal "true"

\end_inset

 corresponding to the 
\emph on
igb=7
\emph default
 option in 
\emph on
sander
\emph default
 and 
\emph on
pmemd
\emph default
.
 Setting gb=8 turns on the updated GB Neck variant of GB, corresponding
 to the 
\emph on
igb=8
\emph default
 option in 
\emph on
sander
\emph default
 and 
\emph on
pmemd
\emph default
.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
rgbmax
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
rgbmax
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
999.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A maximum value for considering pairs of atoms to contribute to the calculation
 of the effective Born radii.
 The default value means that there is effectively no cutoff.
 Calculations will be sped up by using smaller values, say around 15.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset

 or so.
 This parameter is ignored if hcp > 0.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gbsa
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
gbsa
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If set to 1, add a surface-area dependent energy equal to surfen*SASA, where
 surften is discussed below, and SASA is an approximate surface area term.
 NAB uses the "LCPO" approximation developed by Weiser, Shenkin, and Still.
\begin_inset CommandInset citation
LatexCommand cite
key "Weiser99"
literal "true"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
surften
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
surften
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.005
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Surface tension (see 
\shape italic
gbsa
\shape default
, above) in kcal/mol/
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset


\begin_inset Formula $^{2}$
\end_inset

.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
epsext
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
epsext
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
78.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exterior dielectric for generalized Born; interior dielectric is always
 1.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
kappa
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
kappa
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Inverse of the Debye-Hueckel length, if gb is turned on, in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset


\begin_inset Formula $^{-1}$
\end_inset

.
 This parameter is related to the ionic strength as 
\begin_inset Formula $\kappa=[8\pi\beta I/\varepsilon]^{1/2}$
\end_inset

, where 
\begin_inset Formula $I$
\end_inset

 is the ionic strength (same as the salt concentration for a 1-1 salt).
 For 
\begin_inset Formula $T$
\end_inset

=298.15 and 
\begin_inset Formula $\varepsilon$
\end_inset

=78.5, 
\begin_inset Formula $\kappa=(0.10806\,I)^{1/2}$
\end_inset

, where 
\begin_inset Formula $I$
\end_inset

 is in [M].
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ipb
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ipb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Switch to compute electrostatic solvation free energy.
 If set to 0 then PBSA is off.
 This is equivalent to the ipb option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
0
\series default
, 
\series bold
1
\series default
, 
\series bold
2
\series default
, and 
\series bold
4
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
inp
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
inp
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to select different methods to compute non-polar solvation free energy.
 This is equivalent to the inp option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
0
\series default
, 
\series bold
1
\series default
, and 
\series bold
2
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
epsin
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
epsin
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the dielectric constant of the solute region.
 The solute region is defined to be the solvent excluded volume.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
epsout
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
epsout
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
80.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the implicit solvent dielectric constant.
 The solvent region is defined to be the space not occupied the solute region.
 Thus, only two dielectric regions are allowed in the current release.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
smoothopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
smoothopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Instructs PB how to set up dielectric values for finite-difference grid
 edges that are located across the solute/solvent dielectric boundary.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
istrng
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
istrng
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the ionic strength (in mM) for the PB equation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
radiopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
radiopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to set up atomic radii.
 This is equivalent to the radiopt option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
0
\series default
, and 
\series bold
1
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
dprob
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
dprob
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solvent probe radius for molecular surface used to define the dielectric
 boundary between solute and solvent.
 If set 0.0, it would be later assigned to the value of sprob.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
iprob
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
iprob
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mobile ion probe radius for ion accessible surface used to define the Stern
 layer.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
npbopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
npbopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to select the linear or the full nonlinear PB equation.
\end_layout

\begin_layout Plain Layout
= 
\series bold
0
\series default
 Linear PB equation is solved.
\end_layout

\begin_layout Plain Layout
= 
\series bold
1
\series default
 Nonlinear PB equation is solved.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
solvopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
solvopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to select iterative solvers.
 This is equivalent to the solvopt option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
1
\series default
, 
\series bold
2
\series default
, 
\series bold
3
\series default
, 
\series bold
4
\series default
, 
\series bold
5
\series default
, and 
\series bold
6
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
accept
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
accept
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the iteration convergence criterion (relative to the initial residue).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
maxitn
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
maxitn
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the maximum number of iterations for the finite difference solvers,
 default to 100.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
fillratio
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
fillratio
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The ratio between the longest dimension of the rectangular finite-difference
 grid and that of the solute.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
space
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
space
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the grid spacing for the finite difference solver.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nfocus
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nfocus
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set how many successive FD calculations will be used to perform an electrostatic
 focussing calculation on a molecule.
 Possible values: 
\series bold
1
\series default
 and 
\series bold
2
\series default
.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
fscale
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
fscale
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set the ratio between the coarse and fine grid spacings in an electrostatic
 focussing calculation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
bcopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
bcopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Boundary condition options.
 This is equivalent to the bcopt option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
1
\series default
, 
\series bold
5
\series default
, 
\series bold
6
\series default
, and 
\series bold
10
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
eneopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
eneopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to compute total electrostatic energy and forces.
 This is equivalent to the eneopt option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
1
\series default
, and 
\series bold
2
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
dbfopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
dbfopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
This keyword is phased out in this release.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
frcopt
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
frcopt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Option to compute and output electrostatic forces to a file named force.dat
 in the working directory.
 This is equivalent to the frcopt option in 
\emph on
pbsa
\emph default
.
 Possible values: 
\series bold
0
\series default
, 
\series bold
1
\series default
, 
\series bold
2
\series default
, and 
\series bold
3
\series default
.
 See PBSA chapter for more information.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
cutnb
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
cutnb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Atom-based cutoff distance for van der Waals interactions, and pairwise
 Coulombic interactions when ENEOPT = 2.
 When ENEOPT = 1, this is the cutoff distance used for van der Waals interaction
s only.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
sprob
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
sprob
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.557
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Solvent probe radius for solvent accessible surface area (SASA) used to
 compute the dispersion term.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
npbverb
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
npbverb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
This turns on verbose mode in PB when set to 1.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
arcres
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
arcres
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
gives the resolution (in the unit of 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset

) of dots used to represent solvent accessible arcs.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
maxarcdot
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
maxarcdot
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
1500 actually means automatically determine number of arc dots required
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 for solvent accessible surface, might grow too large to fit machines with
 less available memory.
 Please assign it to 4000~7000 and see if it fits into your computers.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
npbgrid
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
npbgrid
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
How many step do pbsa wait to re-calculate the geometry in a simulation,
 npbgrid = 1 is required to do trajectory evaluation.
 npbgrid is recommended to be 100 if 
\begin_inset Quotes eld
\end_inset

conjgrad
\begin_inset Quotes erd
\end_inset

 is used.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
irism
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
irism
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Use 3D-RISM.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

0 Off.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

1 On.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
xvvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
xvvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
.xvv
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 file which describes bulk solvent properties.
 Required for 3D-RISM calculations.
 Produced by 
\family sans
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
rism1d
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
guvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
guvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Root name for solute-solvent 3D pair distribution function,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $G^{\text{UV}}\left(\mathbf{R}\right)$
\end_inset

.
 This will produce one file for each solvent atom type for each frame requested.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
huvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
huvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solute-solvent 3D total correlation function, 
\begin_inset Formula $H^{\text{UV}}(\mathbf{R})$
\end_inset

.
 This will produce one file for each solvent atom type for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
cuvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
cuvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solute-solvent 3D total correlation function, 
\begin_inset Formula $C^{\text{UV}}(\mathbf{R})$
\end_inset

.
 This will produce one file for each solvent atom type for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
quvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
quvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solvent 3D charge density distribution [
\emph on
e/
\emph default
Å].
 This will produce one file with contributions from each solvent atom type
 for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
chgdist
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
chgdist
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solvent 3D charge distribution [
\emph on
e
\emph default
].
 This will produce one file with contributions from each solvent atom type
 for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
uuvfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
uuvfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solute-solvent 3D potential energy, 
\begin_inset Formula $U^{\text{UV}}(\mathbf{R})$
\end_inset

.
 This will produce one file for each solvent atom type for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
asympfile
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
asympfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Rootname for solute-solvent 3D long range real-space asymptotics for 
\begin_inset Formula $C$
\end_inset

 and 
\begin_inset Formula $H$
\end_inset

.
 This will produce one file for 
\begin_inset Formula $C$
\end_inset

 and 
\begin_inset Formula $H$
\end_inset

 for each frame requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
exchemfile
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
exchemfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Root name for 3D excess chemical potential distribution files.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
solvenefile
\begin_inset Index idx
status open

\begin_layout Plain Layout

\family sans
solvenefile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Root name for 3D solvation energy distribution files.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
entropyfile
\begin_inset Index idx
status open

\begin_layout Plain Layout

\family sans
entropyfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Root name for 3D solvation entropy distribution files.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
potUVfile
\begin_inset Index idx
status open

\begin_layout Plain Layout

\family sans
potUVfile
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Root name for 3D solute-solvent potential energy distribution files.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
molReconstruct
\begin_inset Index idx
status open

\begin_layout Plain Layout

\family sans
molReconstruct
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
For any thermodynamic distributions requested, also out the molecular reconstruc
tion (see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Molecular-Reconstruction"

\end_inset

).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
volfmt
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
volfmt
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dx
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output format for volumetric data.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

mrc (default) MRC format.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

ccp4 CCP4 format.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

dx DX format.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

xyzv XYZV format.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
closure
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
closure
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
KH
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Comma separate list of closure approximations.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

HNC Hyper-netted chain equation (HNC).
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

KH Kovalenko-Hirata (KH).
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

PSEn Partial series expansion of order 
\begin_inset Formula $n$
\end_inset

 where 
\begin_inset Quotes eld
\end_inset

n
\begin_inset Quotes erd
\end_inset

 is a positive integer.
\end_layout

\begin_layout Plain Layout
If more than one closure is provided, the 3D-RISM solver will use the closures
 in order to obtain a solution for the last closure in the list when no
 previous solutions are available.
 The solution for the last closure in the list is used for all output.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
closureorder
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
closureorder
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(Deprecated) Order for PSE-n closure if closure is specified as 
\begin_inset Quotes eld
\end_inset

PSE
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

PSEN
\begin_inset Quotes erd
\end_inset

 (no integers).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
solvcut
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
solvcut
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
buffer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cut-off distance for solvent-solute potential and force calculations.
 
\family typewriter
solvcut
\family default
 must be explicitly set if 
\family sans
buffer
\family default

\begin_inset Formula $<0$
\end_inset

.
 For minimization it is recommended to not use a cut-off (e.g.
 
\family sans
solvcut
\family typewriter
=9999
\family default
).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
buffer
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
buffer
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimum distance in Å between the solute and the edge of the solvent box.
\end_layout

\begin_layout Description
<
\begin_inset space \space{}
\end_inset

0 Use fixed box size (
\family typewriter
ng3
\family default
 and 
\family typewriter
solvbox
\family default
).
\end_layout

\begin_layout Description
>=
\begin_inset space \space{}
\end_inset

0 Buffer distance.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
grdspc
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
grdspc
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linear grid spacing in x-, y- and z-dimensions [Å].
 May be specified as single number if all dimensions have the same value.
 E.g., `grdspc=0.5' is equivalent to `grdspc=0.5,0.5,0.5'.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ng
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
ng
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the number of grid points for a fixed size solvation box.
 May be specified as single integer if all dimensions have the same value.
 E.g., `ng=64' is equivalent to `ng=64,64,64'.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
solvbox
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
solvbox
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n/a
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sets the size in Å of the fixed size solvation box.
 May be specified as single number if all dimensions have the same value.
 E.g., `solvbox=32.0' is equivalent to `solvbox=32.0,32.0,32.0'.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
tolerance
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1e-5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A list of maximum residual values for solution convergence.
 When used in combination with a list of closures it is possible to define
 different tolerances for each of the closures.
 This can be useful for difficult to converge calculations (see §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:rism-Solution-Convergence"

\end_inset

).
 For the sake of efficiency, it is best to use as high a tolerance as possible
 for all but the last closure.
 For minimization a tolerance of 1e-11 or lower is recommended.
 Three formats of list are possible.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
one
\begin_inset space ~
\end_inset

tolerance All closures but the last use a tolerance of 1.
 The last tolerance in the list is used by the last closure.
 In practice this, is the most efficient.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
two
\begin_inset space ~
\end_inset

tolerances All closures but the last use the first tolerance in the list.
 The last tolerance in the list is used by the last closure.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
\begin_inset Formula $n$
\end_inset


\begin_inset space ~
\end_inset

tolerances Tolerances from the list are assigned to the closure list in
 order.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
ljTolerance
\family typewriter
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
ljTolerance
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Determines the Lennard-Jones cutoff distance based on the desired accuracy
 of the calculation.
 See §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:RISM-Numerical-Accuracy"

\end_inset

 for details on how this affects numerical accuracy and how this interacts
 with 
\family typewriter
tolerance
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
tolerance
\end_layout

\end_inset

, 
\family typewriter
buffer
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
buffer
\end_layout

\end_inset

, and 
\family typewriter
solvbox
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
solvbox
\end_layout

\end_inset


\family default
.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
asympKSpaceTolerance
\family typewriter
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
asympKSpaceTolerance
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Determines the reciprocal space long range asymptotics cutoff distance based
 on the desired accuracy of the calculation.
 See §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:RISM-Numerical-Accuracy"

\end_inset

 for details on how this affects numerical accuracy.
 Possible values are
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
\begin_inset Formula $<0$
\end_inset

 
\family typewriter
asympKSpaceTolerance=tolerance/10,
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
0 no cutoff, and
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
\begin_inset Formula $>0$
\end_inset

 given value determines the maximum error in the reciprocal-space long range
 asymptotics calculations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeDCF
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeDCF
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use direct sum or the treecode approximation to calculate the direct correlation
 function long-range asymptotic correction.
\end_layout

\begin_layout Description
0 Use direct sum.
\end_layout

\begin_layout Description
1 Use treecode approximation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeTCF
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeTCF
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use direct sum or the treecode approximation to calculate the total correlation
 function long-range asymptotic correction.
\end_layout

\begin_layout Description
0 Use direct sum.
\end_layout

\begin_layout Description
1 Use treecode approximation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeCoulomb
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeCoulomb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use direct sum or the treecode approximation to calculate the Coulomb potential
 energy.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Description
0 Use direct sum.
\end_layout

\begin_layout Description
1 Use treecode approximation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeDCFMAC
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeDCFMAC
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode multipole acceptance criterion for the direct correlation function
 long-range asymptotic correction.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeTCFMAC
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeTCFMAC
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode multipole acceptance criterion for the total correlation function
 long-range asymptotic correction.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeCoulombMAC
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeCoulombMAC
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode multipole acceptance criterion for the Coulomb potential energy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeDCFOrder
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeDCFOrder
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode Taylor series order for the direct correlation function long-range
 asymptotic correction.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeTCFOrder
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeTCFOrder
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode Taylor series order for the total correlation function long-range
 asymptotic correction.
 Note that the Taylor expansion used does not converge exactly to the TCF
 long-range asymptotic correction, so a very high order will not necessarily
 increase accuracy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeCoulombOrder
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeCoulombOrder
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Treecode Taylor series order for the Coulomb potential energy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeDCFN0
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeDCFN0
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of grid points contained within the treecode leaf clusters
 for the direct correlation function long-range asymptotic correction.
 This sets the depth of the hierarchical octtree.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeTCFN0
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeTCFN0
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of grid points contained within the treecode leaf clusters
 for the total correlation function long-range asymptotic correction.
 This sets the depth of the hierarchical octtree.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
treeCoulombN0
\series default

\begin_inset Index idx
status open

\begin_layout Plain Layout
treeCoulombN0
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of grid points contained within the treecode leaf clusters
 for the Coulomb potential energy.
 This sets the depth of the hierarchical octtree.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mdiis_del
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
mdiis_del
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

Step size
\begin_inset Quotes erd
\end_inset

 in MDIIS.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mdiis_nvec
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
mdiis_nvec
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of vectors used by the MDIIS method.
 Higher values for this parameter can greatly increase memory requirements
 but may also accelerate convergence.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mdiis_restart
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
mdiis_restart
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If the current residual is 
\family typewriter
mdiis_restart
\family default
 times larger than the smallest residual in memory, then the MDIIS procedure
 is restarted using the lowest residual solution stored in memory.
 Increasing this number can sometimes help convergence.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mdiis_method
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
mdiis_method
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Specify implementation of the MDIIS routine.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

0 Original reference implementation.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

1 BLAS optimized.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

2 BLAS and memory optimized.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
maxstep
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
maxstep
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of iterations allowed to converge on a solution.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
npropagate
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
npropagate
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of previous solutions propagated forward to create an initial guess
 for this solute atom configuration.
 
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 Do not use any previous solutions
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

1..5 Values greater than 0 but less than 4 or 5 will use less system memory
 but may introduce artifacts to the solution (e.g., energy drift).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
centering
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
centering
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Controls how the solute is centered/re-centered in the solvent box.
 (See 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:Solvation-Box-Size"

\end_inset

.)
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

-4 Center-of-geometry with grid-point rounding.
 Center on first step only.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

-3 Center-of-mass with grid-point rounding.
 Center on first step only.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

-2 Center-of-geometry.
 Center on first step only.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

-1 Center-of-mass.
 Center on first step only.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 No centering.
 Dangerous.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

1 Center-of-mass.
 Center on every step.
 Recommended for molecular dynamics.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

2 Center-of-geometry.
 Center on every step.
 Recommended for minimization.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

3 Center-of-mass with grid-point rounding.
 
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

4 Center-of-geometry with grid-point rounding.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
zerofrc
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
zerofrc
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Redistribute solvent forces across the solute such that the net solvation
 force on the solute is zero.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 Unmodified forces.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

1 Zero net force.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
apply_rism_force
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
apply_rism_force
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Calculate and use solvation forces from 3D-RISM.
 Not calculating these forces can save computation time and is useful for
 trajectory post-processing.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 Do not calculate forces.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

1 Calculate forces.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ntwrism
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ntwrism
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indicates that solvent density grid should be written to file every 
\family typewriter
ntwrism
\family default
 iterations.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 No files written.
\end_layout

\begin_layout Description
>=
\begin_inset space \space{}
\end_inset

1 Output every 
\family sans
ntwrism
\family default
 time steps.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ntprism
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
ntprism
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indicates that 3D-RISM thermodynamic output should be written to file every
 
\family typewriter
ntprism
\family default
 iterations.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 No files written.
\end_layout

\begin_layout Description
>=
\begin_inset space \space{}
\end_inset

1 Output every 
\family sans
ntwrism
\family default
 time steps.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
polarDecomp
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
polarDecomp
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Decompose the solvation free energy into polar and non-polar contributions.
 This is only useful if 
\family sans
ntprism
\family default

\begin_inset Formula $\neq0$
\end_inset

 and adds about 80% to the total calculation time.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

0 No decomposition.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

1 Decomposition is performed.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
entropicDecomp
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
entropicDecomp
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Decomposes solvation free energy into energy and entropy components.
 Also performs temperature derivatives of other calculated quantities.
 Note that this typically requires 80% more computation time and requires
 a 
\family sans
.xvv
\family default
 file version 1.000 or higher (see §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:rism:Analytic-Temperature-Derivatives"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:rism:Work-Flow"

\end_inset

).
 
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

0 No entropic decomposition.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

1 Entropic decomposition.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gf
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Gaussian fluctuation
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compute the Gaussian fluctuation excess chemical potential functional (see
 §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:3D-RISM"

\end_inset

).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
pcpluscorrection
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
PC+/3D-RISM
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compute the PC+/3D-RISM excess chemical potential functional (see §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:rism:Solvation-Free-Energy-Corrections"

\end_inset

).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
uccoeff
\family default

\begin_inset Index idx
status open

\begin_layout Plain Layout
Universal Correction
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0,0,0,0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compute the UC excess chemical potential functional with the provided coefficien
ts (see §
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:rism:Solvation-Free-Energy-Corrections"

\end_inset

).
 
\emph on
a
\emph default
 and 
\emph on
b
\emph default
 are the coefficients for the original UC functional, though using the closure
 excess chemical potential functional.
 
\emph on
a1
\emph default
 and 
\emph on
b1
\emph default
 are optional and provide temperature dependence to the correction (UCT
 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Johnson16"
literal "true"

\end_inset

).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
verb
\family default
ose
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
verbose
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Indicates level of diagnostic detail about the calculation written to the
 log file.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

0 No output.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

1 Print the number of iterations required to converge.
\end_layout

\begin_layout Description
=
\begin_inset space \space{}
\end_inset

2 Print details for each iteration and information about what FCE is doing
 every 
\family sans
progress
\family default
 iterations.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
progress
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
progress
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Display progress of the 3D-RISM solution every 
\family typewriter
progress
\family default
 iterations.
 0 indicates this information will not be displayed.
 Only used if 
\begin_inset Formula $\mathtt{verbose}>1$
\end_inset

.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
static_arrays
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
static_arrays
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
If set to 1, do not allocate dynamic arrays for each call to the 
\family sans
mme()
\family default
 and 
\family sans
mme2()
\family default
 functions.
 The default value of 1 reduces computation time by avoiding array allocation.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
blocksize
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
blocksize
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The granularity with which loop iterations are assigned to OpenMP threads
 or MPI processes.
 For MPI, a 
\family sans
blocksize
\family default
 as small as 1 results in better load balancing during parallel execution.
 For OpenMP, 
\family sans
blocksize
\family default
 should not be smaller than the number of floating-point numbers that fit
 into one cache line in order to avoid performance degradation through 'false
 sharing'.
 For ScaLAPACK, the optimum 
\family sans
blocksize
\family default
 is not know, although a value of 1 is probably too small.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
hcp
\family default

\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
hcp
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Use the GB-HCP model: 
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

0 No GB-HCP.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

1 1-charge approximation.
 
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

2 2-charge approximation.
\end_layout

\begin_layout Description
=
\begin_inset space ~
\end_inset

4 2-charge based on optimal point charge approximation (recommended for
 GB-HCP).
\end_layout

\begin_layout Plain Layout
See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hcp"

\end_inset

 for detailed instructions on using the GB-HCP.
 It is strongly recommended that the NSCM option above be used whenever
 GB-HCP is used.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dhcp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Adjusts the separation between the charges used to approximate uncharged
 components for hcp=4.
 dhcp is empirically determined so that the RMS error in force, compared
 to GB without further approximation, is minimized.
 Our testing on various structures suggests that the optimal value for dhcp
 can be found within the range of 0.1 and 0.4.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:hcp"

\end_inset

 for details.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hcp_h1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GB-HCP level 1 threshold distance.
 The recommended level 1 threshold distance for amino acids is 15A.
 For structures with nucleic acids the recommended level 1 threshold distance
 is 21A.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hcp_h2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GB-HCP level 2 threshold distance.
 The recommended level 2 threshold distance for proteins is 50A.
 For structures with nucleic acids the recommended level 2 threshold distance
 is 90A.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
hcp_h3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GB-HCP level 3 threshold distance.
 The recommended level 3 threshold distance for amino acids is 150A.
 For structures with nucleic acids the recommended level 1 threshold distance
 is 169A.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The 
\family sans
mme()
\family default
 function takes a coordinate set and returns the energy in the function
 value and the gradient of the energy in 
\family sans
grad
\family default
.
 The input parameter 
\shape italic
iter
\shape default
 is used to control printing (see the 
\shape italic
ntpr
\shape default
 variable) and non-bonded updates (see 
\shape italic
nsnb
\shape default
).
 The 
\family sans
mme_rattle()
\family default
 function has the same interface, but constrains the bond lengths and returns
 a corrected gradient.
 If you want to minimize with constrained bond lengths, pass 
\shape italic
mme_rattle
\shape default
 and not 
\shape italic
mme
\shape default
 to the 
\shape italic
conjgrad
\shape default
 routine.
\end_layout

\begin_layout Standard
The 
\family sans
conjgrad()
\family default
 function will carry out conjugate gradient minimization of the function
 
\family sans
func
\family default
 that depends upon 
\family sans
n
\family default
 parameters, whose initial values are in the 
\family sans
x
\family default
 array.
 The function 
\family sans
func
\family default
 must be of the form 
\family sans
func( x[], g[], iter )
\family default
, where 
\family sans
x
\family default
 contains the input values, and the function value is returned through the
 function call, and its gradient with respect to 
\family sans
x
\family default
 through the 
\family sans
g
\family default
 array.
 The iteration number is passed through 
\family sans
iter
\family default
, which 
\family sans
func
\family default
 can use for whatever purpose it wants; a typical use would just be to determine
 when to print results.
 The input parameter 
\family sans
dfpred
\family default
 is the expected drop in the function value on the first iteration; generally
 only a rough estimate is needed.
 The minimization will proceed until 
\family sans
maxiter
\family default
 steps have been performed, or until the root-mean-square of the components
 of the gradient is less than 
\family sans
rmsgrad.

\family default
 The value of the function at the end of the minimization is returned in
 the variable 
\family sans
fret
\family default
.
 
\family sans
conjgrad
\family default
 can return a variety of exit codes: 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="3in">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
Return codes for conjgrad routine
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $>$
\end_inset

0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
minimization converged; gives number of final iteration 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bad line search; probably an error in the relation of the function to its
 gradient (perhaps from round-off if you push too hard on the minimization).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
search direction was uphill
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
exceeded the maximum number of iterations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
could not further reduce function value 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Finally, the 
\family sans
md
\family default
 function will run 
\family sans
maxstep
\family default
 steps of molecular dynamics, using 
\family sans
func
\family default
 as the force field (this would typically be set to a function like 
\family sans
mme
\family default
.) The number of dynamical variables is given as input parameter 
\family sans
n
\family default
: this would be 3 times the number of atoms for ordinary cases, but might
 be different for other force fields or functions.
 The arrays 
\family sans
x[], f[]
\family default
 and 
\family sans
v[]
\family default
 hold the coordinates, gradient of the potential, and velocities, respectively,
 and are updated as the simulation progresses.
 The method of temperature regulation (if any) is specified by the variables
 
\shape italic
tautp
\shape default
 and 
\shape italic
gamma_ln
\shape default
 that are set in 
\shape italic
mm_options()
\shape default
.
\end_layout

\begin_layout Standard

\series bold
Note:
\series default
 In versions of NAB up to 4.5.2, there was an additional input variable to
 
\family sans
md()
\family default
 called 
\shape italic
minv
\shape default
 that reserved space for the inverse of the masses of the particles; this
 has now been removed.
 This change is not backwards compatible: you must modify existing NAB scripts
 that call 
\family sans
md()
\family default
 to remove this variable.
\end_layout

\begin_layout Section
NetCDF read/write routines
\end_layout

\begin_layout Standard
NAB has several routines for reading/writing Amber NetCDF trajectory and
 restart files.
 All of the routines except netcdfGetNextFrame() return a 1 on error, 0
 on success.
 The netcdfGetNextFrame() routine returns 0 on error, 1 on success to make
 it easier to use in loops.
 For an example of how to use NetCDF files in NAB see the NAB script in
 
\series bold
'$AMBERHOME/AmberTools/test/nab/tnetcdf.nab'
\series default
.
\end_layout

\begin_layout Subsection
struct AmberNetcdf
\end_layout

\begin_layout Standard
An AmberNetcdf struct must be used to interface with the netcdf commands
 in NAB (except netcdfWriteRestart()).
 It contains many fields, but the following are the ones commonly needed
 by users:
\end_layout

\begin_layout Description
temp0 Temperature of current frame (if temperature is present).
\end_layout

\begin_layout Description
restartTime Simulation time if NetCDF restart.
\end_layout

\begin_layout Description
isNCrestart 0 if trajectory, 1 if restart.
\end_layout

\begin_layout Description
ncframe Number of frames in the file.
\end_layout

\begin_layout Description
currentFrame Current frame number.
\end_layout

\begin_layout Description
ncatom Number of atoms.
\end_layout

\begin_layout Description
ncatom3 Number of coordinates (ncatom * 3).
\end_layout

\begin_layout Description
velocityVID If not -1, velocity information is present.
\end_layout

\begin_layout Description
TempVID If not -1, temperature information is present.
\end_layout

\begin_layout Standard
In order to use it, you must include nab_netcdf.h and declare it as a struct,
 e.g.:
\end_layout

\begin_layout LyX-Code
#include 
\begin_inset Quotes eld
\end_inset

nab_netcdf.h
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout LyX-Code
struct AmberNetcdf NC;
\end_layout

\begin_layout Subsection
netcdfClose
\end_layout

\begin_layout LyX-Code
int netcdfClose(struct AmberNetcdf NC)
\end_layout

\begin_layout Standard
Close NetCDF file associated with 
\series bold
NC
\series default
.
\end_layout

\begin_layout Subsection
netcdfCreate
\end_layout

\begin_layout LyX-Code
int netcdfCreate(struct AmberNetcdf NC, string filename, int natom, int
 isBox)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct to set up.
\end_layout

\begin_layout Description
filename Name of file to create.
\end_layout

\begin_layout Description
natom Number of atoms in file.
\end_layout

\begin_layout Description
isBox 0 = No box coordinates, 1 = Has box coordinates.
\end_layout

\end_deeper
\begin_layout Standard
Create NetCDF trajectory file and associate with struct 
\series bold
NC
\series default
.
 For writing NetCDF restarts, use netcdfWriteRestart().
\end_layout

\begin_layout Subsection
netcdfDebug
\end_layout

\begin_layout LyX-Code
int netcdfDebug(struct AmberNetcdf NC)
\end_layout

\begin_layout Standard
Print debug information for NetCDF file associated with 
\series bold
NC
\series default
.
\end_layout

\begin_layout Subsection
netcdfGetFrame
\end_layout

\begin_layout LyX-Code
int netcdfGetFrame(struct AmberNetcdf NC, int set, float X[], float box[])
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct, previously set up and opened.
\end_layout

\begin_layout Description
set Frame number to read.
\end_layout

\begin_layout Description
X Array to store coordinates (dimension NC.ncatom3).
\end_layout

\begin_layout Description
box Array of dimension 6 to store box coordinates if present (X Y Z ALPHA
 BETA GAMMA); can be NULL.
\end_layout

\end_deeper
\begin_layout Standard
Get coordinates at frame 
\series bold
set
\series default
 (starting from 0).
\end_layout

\begin_layout Subsection
netcdfGetNextFrame
\end_layout

\begin_layout LyX-Code
int netcdfGetNextFrame(struct AmberNetcdf NC, float X[], float box[])
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct, previously set up and opened.
\end_layout

\begin_layout Description
X Array to store coordinates (dimension NC.ncatom3).
\end_layout

\begin_layout Description
box Array of size 6 to store box coordinates if present (X Y Z ALPHA BETA
 GAMMA); can be NULL.
\end_layout

\end_deeper
\begin_layout Standard
Get the coordinates at frame 
\series bold
NC.currentFrame
\series default
 and increment 
\series bold
NC.currentFrame
\series default
 by one.
 Unlike the other netcdf routines, this returns 1 on success and 0 on error
 to make it easy to use in loops.
\end_layout

\begin_layout Subsection
netcdfGetVelocity
\end_layout

\begin_layout LyX-Code
int netcdfGetVelocity(struct AmberNetcdf NC, int set, float V[])
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct, previously set up and opened.
\end_layout

\begin_layout Description
set Frame number to read.
\end_layout

\begin_layout Description
V Array to store velocities (dimension NC.ncatom3).
\end_layout

\end_deeper
\begin_layout Standard
Get velocities at frame 
\series bold
set
\series default
 (starting from 0).
 
\end_layout

\begin_layout Subsection
netcdfInfo
\end_layout

\begin_layout LyX-Code
int netcdfInfo(struct AmberNetcdf NC)
\end_layout

\begin_layout Standard
Print information for 
\series bold
NC
\series default
, including file type, presence of velocity/box/temperature info, and number
 of atoms, coordinates, and frames present.
\end_layout

\begin_layout Subsection
netcdfLoad
\end_layout

\begin_layout LyX-Code
int netcdfLoad(struct AmberNetcdf NC, string filename)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct to set up.
\end_layout

\begin_layout Description
filename Name of NetCDF file to load.
\end_layout

\end_deeper
\begin_layout Standard
Load NetCDF file filename and set up the AmberNetcdf structure 
\series bold
NC
\series default
 for reading.
 The file type is automatically detected.
\end_layout

\begin_layout Subsection
netcdfWriteFrame
\end_layout

\begin_layout LyX-Code
int netcdfWriteFrame(struct AmberNetcdf NC, int set, float X[], float box[])
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct, previously set up and opened.
\end_layout

\begin_layout Description
set Frame number to write.
\end_layout

\begin_layout Description
X Array of coordinates to write (dimension NC.ncatom3).
\end_layout

\begin_layout Description
box Array of size 6 of box coordinates to write (X Y Z ALPHA BETA GAMMA);
 can be NULL.
\end_layout

\end_deeper
\begin_layout Standard
Write to NetCDF trajectory at frame 
\series bold
set
\series default
 (starting from 0).
 NOTE: This routine is for writing NetCDF trajectories only; to write NetCDF
 restarts use netcdfWriteRestart().
\end_layout

\begin_layout Subsection
netcdfWriteNextFrame
\end_layout

\begin_layout LyX-Code
int netcdfWriteNextFrame(struct AmberNetcdf NC, float X[], float box[])
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
NC AmberNetcdf struct, previously set up and opened.
\end_layout

\begin_layout Description
X Array of coordinates to write (dimension NC.ncatom3).
\end_layout

\begin_layout Description
box Array of size 6 of box coordinates to write (X Y Z ALPHA BETA GAMMA);
 can be NULL.
\end_layout

\end_deeper
\begin_layout Standard
Write coordinates to frame 
\series bold
NC.currentFrame
\series default
 and increment 
\series bold
NC.currentFrame
\series default
 by one.
 NOTE: This routine is for writing NetCDF trajectories only; to write NetCDF
 restarts use netcdfWriteRestart().
\end_layout

\begin_layout Subsection
netcdfWriteRestart
\end_layout

\begin_layout LyX-Code
int netcdfWriteRestart(string filename, int natom, float X[], float V[],
 
\end_layout

\begin_layout LyX-Code
                       float box[], float time, float temperature)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
filename Name of NetCDF restart file to create.
\end_layout

\begin_layout Description
natom Number of atoms in netcdf restart file.
\end_layout

\begin_layout Description
X Array of coordinates to write (dimension natom*3).
\end_layout

\begin_layout Description
V Array of velocities to write (dimension natom*3); can be NULL.
\end_layout

\begin_layout Description
box Array of size 6 of box coordinates to write (X Y Z ALPHA BETA GAMMA);
 can be NULL.
\end_layout

\begin_layout Description
time Restart time in ps.
\end_layout

\begin_layout Description
temperature Restart temperature; if < 0 no temperature will be written.
\end_layout

\end_deeper
\begin_layout Section

\series bold
Second derivatives and normal modes
\end_layout

\begin_layout Standard
Russ Brown has contributed codes that compute analytically the second derivative
s of the Amber functions, including the generalized Born terms.
\begin_inset CommandInset citation
LatexCommand citep
key "Brown06"
literal "true"

\end_inset

 This capability resides in the three functions described here.
\end_layout

\begin_layout LyX-Code

\family sans
int newton
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
newton
\end_layout

\end_inset

( float x[], int n, float fret, float func1(), float func2(), float rms,
 
\begin_inset Newline newline
\end_inset

                float nradd, int maxiter );
\end_layout

\begin_layout LyX-Code

\family sans
float nmode
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
nmode
\end_layout

\end_inset

( float x[], int n, float func(), int eigp, int ntrun, float eta, float
 hrmax, int ioseen );
\end_layout

\begin_layout Standard
These routines construct and manipulate a Hessian (second derivative matrix),
 allowing one (for now) to carry out Newton-Raphson minimization and normal
 mode calculations.
 The 
\family sans
mme2()
\family default
 routine takes as input a 
\shape italic
3*natom
\shape default
 vector of coordinates 
\family sans
x[]
\family default
, and returns a gradient vector 
\family sans
g[]
\family default
, a Hessian matrix, stored columnwise in a 
\shape italic
3*natom x 3*natom
\shape default
 vector 
\family sans
h[]
\family default
, and the masses of the system, in a vector 
\family sans
m[]
\family default
 of length 
\shape italic
natom
\shape default
.
 The iteration variable 
\family sans
iter
\family default
 is just used to control printing.
 At present, these routines only work for 
\shape italic
gb
\shape default
 = 0 or 1.
\end_layout

\begin_layout Standard
Users cannot call 
\family sans
mme2()
\family default
 directly, but will pass this as an argument to one of the next two routines.
\end_layout

\begin_layout Standard
The 
\family sans
newton()
\family default
 routine takes a input coordinates 
\family sans
x[]
\family default
 and a size parameter 
\family sans
n
\family default
 (must be set to 
\shape italic
3*natom
\shape default
).
 It performs Newton-Raphson optimization until the root-mean-square of the
 gradient vector is less than 
\family sans
rms
\family default
, or until 
\family sans
maxiter
\family default
 steps have been taken.
 For now, the input function 
\family sans
func1()
\family default
 must be 
\family sans
mme()
\family default
 and 
\family sans
func2()
\family default
 must be 
\family sans
mme2()
\family default
.
 The value 
\family sans
nradd
\family default
 will be added to the diagonal of the Hessian before the step equations
 are solved; this is generally set to zero, but can be set something else
 under particular circumstances, which we do not discuss here.
\begin_inset CommandInset citation
LatexCommand cite
key "Nguyen85"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
Generally, you only want to try Newton-Raphson minimization (which can be
 very expensive) after you have optimized structures with 
\family sans
conjgrad()
\family default
 to an rms gradient of 10 -3 or so.
 In most cases, it should only take a small number of iterations then to
 go down to an rms gradient of about 10 -12 or so, which is somewhere near
 the precision limit.
\end_layout

\begin_layout Standard
Once a good minimum has been found, you can use the nmode() function to
 compute normal/Langevin modes and thermochemical parameters.
 The first three arguments are the same as for newton(), the next two integers
 give the number of eigenvectors to compute and the type of run, respectively.
 The last three arguments (only used for Langevin modes) are the viscosity
 in centipoise, the value for the hydrodynamic radius, and the type of hydrodyna
mic interactions.
 Several techniques are available for diagonalizing the Hessian depending
 on the number of modes required and the amount of memory available.
\end_layout

\begin_layout Standard
In all cases the modes are written to an Amber-compatible "vecs" file for
 normal modes or "lmodevecs" file for Langevin modes.
 There are currently no nab routines that use this format.
 The Langevin modes will also generate an output file called "lmode" that
 can be read by the Amber module 
\emph on
lmanal
\emph default
.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
ntrun
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
0: The dsyev routine is used to diagonalize the Hessian 
\end_layout

\begin_layout Description
1: The dsyevd routine is used to diagonalize the Hessian 
\end_layout

\begin_layout Description
2: The ARPACK package (shift invert technique) is used to obtain a small
 number of eigenvalues
\end_layout

\begin_layout Description
3: The Langevin modes are computed with the viscosity and hydrodynamic radius
 provided 
\end_layout

\end_deeper
\begin_layout Labeling
\labelwidthstring 00.00.0000
hrmax Hydrodynamic radius for the atom with largest area exposed to solvent.
 If a file named "expfile" is provided then the relative exposed areas are
 read from this file.
 If "expfile" is not present all atoms are assigned a hydrodynamic radius
 of hrmax or 0.2 for the hydrogen atoms.
 The "expfile" can be generated with the ms (molecular surface) program.
 
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
ioseen 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
0: Stokes Law is used for the hydrodynamic interaction 
\end_layout

\begin_layout Description
1: Oseen interaction included 
\end_layout

\begin_layout Description
2: Rotne-Prager correction included 
\end_layout

\end_deeper
\begin_layout Standard
Here is a typical calling sequence: 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{lstlisting}[numbers=left,numberstyle=
\backslash
tiny]
\end_layout

\begin_layout Plain Layout

molecule m;
\end_layout

\begin_layout Plain Layout

float x[4000], fret;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

m = getpdb_prm( "mymolecule.pdb", "leaprc.protein.ff14SB", "", 0 );
\end_layout

\begin_layout Plain Layout

mm_options( "cut=999., ntpr=50, nsnb=99999, diel=C, gb=1, dielc=1.0" );
\end_layout

\begin_layout Plain Layout

mme_init( m, NULL, "::Z", x, NULL);
\end_layout

\begin_layout Plain Layout

setxyz_from_mol( m, NULL, x );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

//  conjugate gradient minimization
\end_layout

\begin_layout Plain Layout

conjgrad(x, 3*m.natoms, fret, mme, 0.1, 0.001, 2000 );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

//  Newton-Raphson minimization
\backslash
fP
\end_layout

\begin_layout Plain Layout

mm_options( "ntpr=1" );
\end_layout

\begin_layout Plain Layout

newton( x, 3*m.natoms, fret, mme, mme2, 0.00000001, 0.0, 6 );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// get the normal modes:
\end_layout

\begin_layout Plain Layout

nmode( x, 3*m.natoms, mme2, 0, 0, 0.0, 0.0, 0); 
\end_layout

\begin_layout Plain Layout


\backslash
end{lstlisting}
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:lmod"

\end_inset


\series bold
Low-MODe (LMOD) optimization methods
\end_layout

\begin_layout Standard
Istv
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
'{a}
\end_layout

\end_inset

n Kolossv
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
'{a}
\end_layout

\end_inset

ry has contributed functions, which implement the LMOD methods for minimization,
 conformational searching, and flexible docking.
\begin_inset CommandInset citation
LatexCommand cite
key "Kolossvary96,Kolossvary99,Kolossvary01,Keseru01"
literal "true"

\end_inset

 The centerpiece of LMOD is a conformational search algorithm based on eigenvect
or following of low-frequency vibrational modes.
 It has been applied to a spectrum of computational chemistry domains including
 protein loop optimization and flexible active site docking.
 The search method is implemented without explicit computation of a Hessian
 matrix and utilizes the Arnoldi package (ARPACK, 
\shape italic
http://www.caam.rice.edu/software/ARPACK/
\shape default
) for computing the low-frequency modes.
 LMOD optimization can be thought of as an advanced minimization method.
 LMOD can not only energy minimize a molecular structure in the local sense,
 but can generate a series of very low energy conformations.
 The LMOD capability resides in a single, top-level calling function 
\shape italic
lmod()
\shape default
, which uses fast local minimization techniques, collectively termed XMIN
 that can also be accessed directly through the function 
\shape italic
xmin().
\end_layout

\begin_layout Standard
There are now 
\series bold
four 
\begin_inset Quotes eld
\end_inset

real-life
\begin_inset Quotes erd
\end_inset

 examples
\series default
 of carrying out LMOD searches: look in 
\emph on
$AMBERHOME/AmberTools/examples/nab/lmod_*
\emph default
.
 Each directory has a README file that give more information.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:lmod1"

\end_inset

LMOD conformational searching
\end_layout

\begin_layout Standard
The LMOD conformational search procedure is based on gentle, but very effective
 structural perturbations applied to molecular systems in order to explore
 their conformational space.
 LMOD perturbations are derived from low-frequency vibrational modes representin
g large-amplitude, concerted atomic movements.
 Unlike essential dynamics where such low modes are derived from long molecular
 dynamics simulations, LMOD calculates the modes directly and utilizes them
 to improve Monte Carlo sampling.
\end_layout

\begin_layout Standard
LMOD has been developed primarily for macromolecules, with its main focus
 on protein loop optimization.
 However, it can be applied to any kind of molecular systems, including
 complexes and flexible docking where it has found widespread use.
 The LMOD procedure starts with an initial molecular model, which is energy
 minimized.
 The minimized structure is then subjected to an ARPACK calculation to find
 a user-specified number of low-mode eigenvectors of the Hessian matrix.
 The Hessian matrix is never computed; ARPACK makes only implicit reference
 to it through its product with a series of vectors.
 Hv, where v is an arbitrary unit vector, is calculated via a finite-difference
 formula as follows,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Hv=\left[\nabla(x_{min}+h)-\nabla(x_{min})\right]/h\label{eq:lmod1}
\end{equation}

\end_inset

where 
\begin_inset Formula $x_{min}$
\end_inset

 is the coordinate vector at the energy minimized conformation and 
\begin_inset Formula $h$
\end_inset

 denotes machine precision.
 The computational cost of Eq.
 1 requires a single gradient calculation at the energy minimum point and
 one additional gradient calculation for each new vector.
 Note that 
\begin_inset Formula $\bigtriangledown x$
\end_inset

 is never 0, because minimization is stopped at a finite gradient RMS, which
 is typically set to 0.1-1.0 kcal/mol-
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset

 in most calculations.
\end_layout

\begin_layout Standard
The low-mode eigenvectors of the Hessian matrix are stored and can be re-used
 throughout the LMOD search.
 Note that although ARPACK is very fast in relative terms, a single ARPACK
 calculation may take up to a few hours on an absolute CPU time scale with
 a large protein structure.
 Therefore, it would be impractical to recalculate the low-mode eigenvectors
 for each new structure.
 Visual inspection of the low-frequency vibrational modes of different,
 randomly generated conformations of protein molecules showed very similar,
 collective motions clearly suggesting that low-modes of one particular
 conformation were transferable to other conformations for LMOD use.
 This important finding implies that the time limiting factor in LMOD optimizati
on, even for relatively small molecules, is energy minimization, not the
 eigenvector calculation.
 This is the reason for employing XMIN for local minimization instead of
 NAB's standard minimization techniques.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:lmod2"

\end_inset

LMOD procedure
\end_layout

\begin_layout Standard
Given the energy-minimized structure of an initial protein model, protein-
 ligand complex, or any other molecular system and its low-mode Hessian
 eigenvectors, LMOD proceeds as follows.
 For each of the first n low-modes repeat steps 1-3 until convergence:
\end_layout

\begin_layout Enumerate
Perturb the energy-minimized starting structure by moving along the ith
 (i =1-n) Hessian eigenvector in either of the two opposite directions to
 a certain distance.
 The 3N-dimensional (N is equal to the number of atoms) travel distance
 along the eigenvector is scaled to move the fastest moving atom of the
 selected mode in 3-dimensional space to a randomly chosen distance between
 a user-specified minimum and maximum value.
\begin_inset Newline newline
\end_inset


\emph on
Note
\emph default
: A single LMOD move inherently involves excessive bond stretching and bond
 angle bending in Cartesian space.
 Therefore the primarily torsional trajectory drawn by the low-modes of
 vibration on the PES is severely contaminated by this naive, linear approximati
on and, therefore, the actual Cartesian LMOD trajectory often misses its
 target by climbing walls rather than crossing over into neighboring valleys
 at not too high altitudes.
 The current implementation of LMOD employs a so-called ZIG-ZAG algorithm,
 which consists of a series of alternating short LMOD moves along the low-mode
 eigenvector (ZIG) followed by a few steps of minimization (ZAG), which
 has been found to relax excessive stretches and bends more than reversing
 the torsional move.
 Therefore, it is expected that such a ZIG- ZAG trajectory will eventually
 be dominated by concerted torsional movements and will carry the molecule
 over the energy barrier in a way that is not too different from finding
 a saddle point and crossing over into the next valley like passing through
 a mountain pass.
\begin_inset Newline newline
\end_inset


\emph on
Barrier crossing check:
\emph default
 The LMOD algorithm checks barrier crossing by evaluating the following
 criterion: IF the current endpoint of the zigzag trajectory is lower than
 the energy of the starting structure, OR, the endpoint is at least lower
 than it was in the previous ZIG-ZAG iteration step AND the molecule has
 also moved farther away from the starting structure in terms of all-atom
 superposition RMS than at the previous position THEN it is assumed that
 the LMOD ZIG-ZAG trajectory has crossed an energy barrier.
\end_layout

\begin_layout Enumerate
Energy-minimize the perturbed structure at the endpoint of the ZIG- ZAG
 trajectory.
\end_layout

\begin_layout Enumerate
Save the new minimum-energy structure and return to step 1.
 Note that LMOD saves only low-energy structures within a user-specified
 energy window above the then current global minimum of the ongoing search.
\end_layout

\begin_layout Standard
After exploring the modes of a single structure, LMOD goes on to the next
 starting structure, which is selected from the set of previously found
 low- energy structures.
 The selection is based on either the Metropolis criterion, or simply the
 than lowest energy structure is used.
 LMOD terminates when the user-defined number of steps has been completed
 or when the user-defined number of low-energy conformations has been collected.
\end_layout

\begin_layout Standard
Note that for flexible docking calculations LMOD applies explicit translations
 and rotations of the ligand(s) on top of the low-mode perturbations.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:xmin"

\end_inset

XMIN
\end_layout

\begin_layout LyX-Code
float xmin
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
xmin
\end_layout

\end_inset

( float func(), int natm, float x[], float g[], 
\end_layout

\begin_layout LyX-Code
               float ene, float grms_out, struct xmod_opt xo);
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="4in">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
Parameter list for xmin() 
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
keyword
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
meaning
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
func
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The name of the function that computes the function value and gradient of
 the objective function to be minimized.
 
\shape italic
func()
\shape default
 must have the following argument list: 
\family typewriter
float func( float x[], float g[], int i)
\family default
where 
\family typewriter
x[]
\family default
 is the vector of the iterate, 
\family typewriter
g[]
\family default
 is the gradient and 
\family typewriter
i
\family default
 is currently ignored except when 
\family typewriter
func
\family default
 =
\family typewriter
 mme
\family default
 where 
\family typewriter
i
\family default
 is handled internally.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
natm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of atoms.
 
\series bold
NOTE:
\series default
 if 
\family typewriter
func
\family default
 is other than 
\family typewriter
mme
\family default
, 
\family typewriter
natm
\family default
 is used to pass the total number of variables of the objective function
 to be minimized.
 However, 
\family typewriter
natm
\family default
 retains its original meaning in case 
\family typewriter
func
\family default
 is a user-defined energy function for 3-dimensional (molecular) structure
 optimization.
 Make sure that the meaning of 
\family typewriter
natm
\family default
 is compatible with the setting of 
\family typewriter
mol_struct_opt
\family default
 below.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
x[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coordinate vector.
 User has to allocate memory in calling program and fill x[] with initial
 coordinates using, e.g., the setxyz_from_mol function (see sample program
 below).
 Array size = 3*natm.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
g[] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gradient vector.
 User has to allocate memory in calling program.
 Array size = 3*natm.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ene
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
On output, ene stores the minimized energy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
grms_out
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
On output, grms_out stores the gradient RMS achieved by XMIN.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:xmin"

\end_inset

Arguments for xmin().
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="21" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="4in">
<row>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\shape italic
Parameter list for xmin_opt
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
keyword
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
meaning
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mol_struct_opt
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
1=
\shape default
 3-dimensional molecular structure optimization.
 Any other value means general function optimization.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
maxiter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
1000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of iteration steps allowed for XMIN.
 A value of zero means single point energy calculation, no minimization.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
grms_tol 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gradient RMS threshold below which XMIN should minimize the input structure.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minimization algorithm.
 See text for description.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
numdiff
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Finite difference method used in TNCG for approximating the product of the
 Hessian matrix and some vector in the conjugate gradient iteration (the
 same approximation is used in LMOD, see Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:lmod1"

\end_inset

 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod1"

\end_inset

).
 1= Forward difference.
 2=Central difference.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
m_lbfgs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size of the L-BFGS memory used in either L-BFGS minimization or L-BFGS precondit
ioning for TNCG.
 The value zero turns off preconditioning.
 It usually makes little sense to set the value 
\begin_inset Formula $>$
\end_inset

10.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Amount of debugging printout.
 0= No output.
 1= Minimization details.
 2= Minimization (including conjugate gradient iteration in case of TNCG)
 and line search details.
 If 
\emph on
print_level 
\emph default
> 2, print minimization output every 
\emph on
print_level
\emph default
 steps
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
iter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output parameter.
 The total number of iteration steps completed by XMIN.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
xmin_time 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output parameter.
 CPU time in seconds used by XMIN.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ls_method
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
1=
\shape default
 modified Armijo 
\begin_inset CommandInset citation
LatexCommand cite
key "Shi05"
literal "true"

\end_inset

(not recommended, primarily used for testing).
\end_layout

\begin_layout Plain Layout

\shape italic
2=
\shape default
 Wolfe (after J.
 J.
 More' and D.
 J.
 Thuente).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ls_maxiter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum number of line search steps per single minimization step.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ls_maxatmov
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum (co-ordinate) movement per degree of freedom allowed in line search,
 range 
\shape italic
> 0
\shape default
.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
beta_armijo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Armijo beta parameter, range (0, 1).
 
\shape italic
Only change it if you know what you are doing.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
c_armijo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Armijo c parameter, range (0, 0.5).

\shape italic
 Only change it if you know what you are doing.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mu_armijo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Armijo mu parameter, range [0, 2).
 
\shape italic
Only change it if you know what you are doing.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ftol_wolfe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.0001
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Wolfe ftol parameter, range (0, 0.5).
 
\shape italic
Only change it if you know what you are doing.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
gtol_wolfe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0.9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Wolfe gtol parameter, range (ftol_wolfe, 1).
 
\shape italic
Only change it if you know what you are doing.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ls_iter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output parameter.
 The total number of line search steps completed by XMIN.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
error_flag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Output parameter.
 A nonzero value indicates an error.
 In case of an error XMIN will always print a descriptive error message.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:xmin-1"

\end_inset

Options for xmin_opt.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
At a glance: The 
\shape italic
xmin()
\shape default
 function minimizes the energy of a molecular structure with initial coordinates
 given in the x[] array.
 On output, 
\shape italic
xmin()
\shape default
 returns the minimized energy as the function value and the coordinates
 in x[] will be updated to the minimum-energy conformation.
 The arguments to xmin() are described in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:xmin"

\end_inset

; the parameters in the xmin_opt structure are described in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:xmin-1"

\end_inset

; these should be preceded by 
\family typewriter

\begin_inset Quotes eld
\end_inset

xo.
\begin_inset Quotes erd
\end_inset


\family default
, since they are members of an 
\emph on
xmod_opt
\emph default
 struct with that name; see the sample program below to see how this works.
 
\end_layout

\begin_layout Standard
There are three types of minimizers that can be used, specified by the 
\emph on
method
\emph default
 parameter:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
method
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description

\emph on
1: 
\emph default
PRCG Polak-Ribiere conjugate gradient method, similar to the 
\shape italic
conjgrad()
\shape default
 function 
\begin_inset CommandInset citation
LatexCommand cite
key "Press89"
literal "true"

\end_inset

.
\end_layout

\begin_layout Description

\emph on
2:
\emph default
 L-BFGS Limited-memory Broyden-Fletcher-Goldfarb-Shanno quasi-Newton algorithm
 
\begin_inset CommandInset citation
LatexCommand cite
key "Liu89"
literal "true"

\end_inset

.
 L-BFGS is 2-3 times faster than PRCG mainly, because it requires significantly
 fewer line search steps than PRCG.
\end_layout

\begin_layout Description

\emph on
3:
\emph default
 lbfgs-TNCG L-BFGS preconditioned truncated Newton conjugate gradient algorithm
 
\begin_inset CommandInset citation
LatexCommand cite
key "Press89,Nocedal00"
literal "true"

\end_inset

.
 Sophisticated technique that can minimize molecular structures to lower
 energy and gradient than PRCG and L-BFGS and requires an order of magnitude
 fewer minimization steps, but L-BFGS can sometimes be faster in terms of
 total CPU time.
\end_layout

\begin_layout Description
4: Debugging option; printing analytical and numerical derivatives for compariso
n.
 Almost all failures with 
\emph on
xmin
\emph default
 can be attributed to inaccurate analytical derivatives, e.g., when SCF hasn't
 converged with a quantum based Hamiltonian.
\end_layout

\end_deeper
\begin_layout Standard
NOTE: The xmin routine can be utilized for minimizing arbitrary, user-defined
 objective functions.
 The function must be defined in a user NAB program or in any other user
 library that is linked in.
 The name of the function is passed to 
\shape italic
xmin()
\shape default
 via the 
\shape italic
func 
\shape default
argument.
\end_layout

\begin_layout Subsection

\series bold
Sample XMIN program
\end_layout

\begin_layout Standard
The following sample program, which is based on the test program txmin.nab,
 reads a molecular structure from a PDB file, minimizes it, and saves the
 minimized structure in another PDB file.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{lstlisting}[numbers=left,numberstyle=
\backslash
tiny]
\end_layout

\begin_layout Plain Layout

//   XMIN reverse communication external minimization package.
\end_layout

\begin_layout Plain Layout

//   Written by Istvan Kolossvary.
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

#include "xmin_opt.h"
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// M A I N  P R O G R A M  to carry out XMIN minimization on a molecule:
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

struct xmin_opt xo;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

molecule mol;
\end_layout

\begin_layout Plain Layout

int natm;
\end_layout

\begin_layout Plain Layout

float xyz[ dynamic ], grad[ dynamic ];
\end_layout

\begin_layout Plain Layout

float energy, grms;
\end_layout

\begin_layout Plain Layout

point dummy;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    xmin_opt_init( xo );  //  set up defaults (shown here)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    // xo.mol_struct_opt = 1;
\end_layout

\begin_layout Plain Layout

    // xo.maxiter        = 1000;
\end_layout

\begin_layout Plain Layout

    // xo.grms_tol       = 0.05;
\end_layout

\begin_layout Plain Layout

    // xo.method         = 3;
\end_layout

\begin_layout Plain Layout

    // xo.numdiff        = 1;
\end_layout

\begin_layout Plain Layout

    // xo.m_lbfgs        = 3;
\end_layout

\begin_layout Plain Layout

    //    xo.ls_method   = 2;
\end_layout

\begin_layout Plain Layout

    //    xo.ls_maxiter  = 20;
\end_layout

\begin_layout Plain Layout

    //    xo.maxatmov    = 0.5;
\end_layout

\begin_layout Plain Layout

    //    xo.beta_armijo = 0.5;
\end_layout

\begin_layout Plain Layout

    //    xo.c_armijo    = 0.4;
\end_layout

\begin_layout Plain Layout

    //    xo.mu_armijo   = 1.0;
\end_layout

\begin_layout Plain Layout

    //    xo.ftol_wolfe  = 0.0001;
\end_layout

\begin_layout Plain Layout

    //    xo.gtol_wolfe  = 0.9;
\end_layout

\begin_layout Plain Layout

    // xo.print_level    = 0;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    xo.maxiter     = 10;  //  non-defaults are here
\end_layout

\begin_layout Plain Layout

    xo.grms_tol    = 0.001;
\end_layout

\begin_layout Plain Layout

    xo.method      = 3;
\end_layout

\begin_layout Plain Layout

    xo.ls_maxatmov = 0.15;
\end_layout

\begin_layout Plain Layout

    xo.print_level = 2;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    mol = getpdb( "gbrna.pdb" );
\end_layout

\begin_layout Plain Layout

    readparm( mol, "gbrna.prmtop" );
\end_layout

\begin_layout Plain Layout

    natm = mol.natoms;
\end_layout

\begin_layout Plain Layout

    allocate xyz[ 3*natm ]; allocate grad[ 3*natm ];
\end_layout

\begin_layout Plain Layout

    setxyz_from_mol( mol, NULL, xyz );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    mm_options( "ntpr=1, gb=1, kappa=0.10395, rgbmax=99., cut=99.0, diel=C
 ");
\end_layout

\begin_layout Plain Layout

    mme_init( mol, NULL, "::ZZZ", dummy, NULL );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    energy = mme( xyz, grad, 0 );
\end_layout

\begin_layout Plain Layout

    energy = xmin( mme, natm, xyz, grad, energy, grms, xo );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// E N D  M A I N
\end_layout

\begin_layout Plain Layout


\backslash
end{lstlisting}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The corresponding screen output should look similar to this.
 Note that this is fairly technical, debugging information; normally print_level
 is set to zero.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{lstlisting}
\end_layout

\begin_layout Plain Layout

Reading parm file (gbrna.prmtop)
\end_layout

\begin_layout Plain Layout

title:
\end_layout

\begin_layout Plain Layout

PDB 5DNB, Dickerson decamer
\end_layout

\begin_layout Plain Layout

old prmtop format => using old algorithm for GB parms
\end_layout

\begin_layout Plain Layout

      mm_options:  ntpr=99
\end_layout

\begin_layout Plain Layout

      mm_options:  gb=1
\end_layout

\begin_layout Plain Layout

      mm_options:  kappa=0.10395
\end_layout

\begin_layout Plain Layout

      mm_options:  rgbmax=99.
\end_layout

\begin_layout Plain Layout

      mm_options:  cut=99.0
\end_layout

\begin_layout Plain Layout

      mm_options:  diel=C
\end_layout

\begin_layout Plain Layout

    iter    Total    bad         vdW     elect.
     cons.
   genBorn   frms
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

ff:   0  -4107.50    906.22   -192.79   -137.96      0.00  -4682.97 1.93e+01
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

________________________________________________________________
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

 MIN:                          It=    0  E=   -4107.50 ( 19.289)
\end_layout

\begin_layout Plain Layout

  CG:   It=    3 (  0.310)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.94735  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    1  E=   -4423.34 (  5.719)
\end_layout

\begin_layout Plain Layout

  CG:   It=    4 (  0.499)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.91413  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    2  E=   -4499.43 (  2.674)
\end_layout

\begin_layout Plain Layout

  CG:   It=    9 (  0.498)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.86829  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    3  E=   -4531.20 (  1.543)
\end_layout

\begin_layout Plain Layout

  CG:   It=    8 (  0.499)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.95556  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    4  E=   -4547.59 (  1.111)
\end_layout

\begin_layout Plain Layout

  CG:   It=    9 (  0.491)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.77247  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    5  E=   -4556.35 (  1.068)
\end_layout

\begin_layout Plain Layout

  CG:   It=    8 (  0.361)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.75150  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    6  E=   -4562.95 (  1.042)
\end_layout

\begin_layout Plain Layout

  CG:   It=    8 (  0.273)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.79565  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    7  E=   -4568.59 (  0.997)
\end_layout

\begin_layout Plain Layout

  CG:   It=    5 (  0.401)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.86051  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    8  E=   -4572.93 (  0.786)
\end_layout

\begin_layout Plain Layout

  CG:   It=    4 (  0.335)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.88096  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=    9  E=   -4575.25 (  0.551)
\end_layout

\begin_layout Plain Layout

  CG:   It=   64 (  0.475)  :-)
\end_layout

\begin_layout Plain Layout

  LS: step= 0.95860  it= 1  info= 1
\end_layout

\begin_layout Plain Layout

 MIN:                          It=   10  E=   -4579.19 (  0.515)
\end_layout

\begin_layout Plain Layout

----------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

 FIN:             :-)                    E=   -4579.19 (  0.515)
\end_layout

\begin_layout Plain Layout


\backslash
end{lstlisting}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first few lines are typical NAB output from mm_init() and mme().
 The output below the horizontal line comes from XMIN.
 The MIN/CG/LS blocks contain the following pieces of information.
 The MIN: line shows the current iteration count, energy and gradient RMS
 (in parentheses).
 The CG: line shows the CG iteration count and the residual in parentheses.
 The happy face :-) means convergence whereas :-( indicates that CG iteration
 encountered negative curvature and had to abort.
 The latter situation is not a serious problem, minimization can continue.
 This is just a safeguard against uphill moves.
 The LS: line shows line search information.
 "step" is the relative step with respect to the initial guess of the line
 search step.
 "it" tells the number of line search steps taken and "info" is an error
 code.
 "info" = 1 means that line searching converged with respect to sufficient
 decrease and curvature criteria whereas a non- zero value indicates an
 error condition.
 Again, an error in line searching doesn't mean that minimization necessarily
 failed, it just cannot proceed any further because of some numerical dead
 end.
 The FIN: line shows the final result with a happy face :-) if either the
 grms_tol criterion has been met or when the number of iteration steps reached
 the maxiter value.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:lmod3"

\end_inset

LMOD
\end_layout

\begin_layout LyX-Code
float lmod
\begin_inset Index idx
status collapsed

\begin_layout Plain Layout
lmod
\end_layout

\end_inset

( int natm, float x[], float g[], float ene, float conflib[], 
\end_layout

\begin_layout LyX-Code
       float lmod_traj[], int lig_start[], int lig_end[], int lig_cent[],
 
\end_layout

\begin_layout LyX-Code
       float tr_min[], float tr_max[], float rot_min[], float rot_max[],
 
\end_layout

\begin_layout LyX-Code
       struct xmin_opt, struct xmin_opt, struct lmod_opt);
\end_layout

\begin_layout Standard
At a glance: The 
\shape italic
lmod()
\shape default
 function is similar to 
\shape italic
xmin()
\shape default
 in that it optimizes the energy of a molecular structure with initial coordinat
es given in the x[] array.
 However, the optimization goes beyond local minimization, it is a sophisticated
 conformational search procedure.
 On output, 
\shape italic
lmod()
\shape default
 returns the global minimum energy of the LMOD conformational search as
 the function value and the coordinates in x[] will be updated to the global
 minimum-energy conformation.
 Moreover, a set of the best low-energy conformations is also returned in
 the array conflib[].
 Coordinates, energy, and gradient are in NAB units.
 The parameters are given in the table below; items above the line are passed
 as parameters; the rest of the parameters are all preceded by 
\family typewriter

\begin_inset Quotes eld
\end_inset

lo.
\begin_inset Quotes erd
\end_inset


\family default
, because they are members of an 
\emph on
lmod_opt
\emph default
 struct with that name; see the sample program below to see how this works.
\end_layout

\begin_layout Standard
Also note that 
\shape italic
xmin()
\shape default
's 
\shape italic
xmin_opt
\shape default
 struct is passed to 
\shape italic
lmod()
\shape default
 as well.
 
\shape italic
lmod()
\shape default
 changes the default values of some of the 
\family typewriter

\begin_inset Quotes eld
\end_inset

xo.
\begin_inset Quotes erd
\end_inset


\family default
 parameters via the call to 
\shape italic
lmod_opt_int()
\shape default
 relative to a call to 
\shape italic
xmin_opt_init()
\shape default
, which means that in a more complex NAB program with multiple calls to
 
\shape italic
xmin()
\shape default
 and 
\shape italic
lmod()
\shape default
; make sure to always initialize and set user parameters for each and every
 XMIN and LMOD search via, respectively calling 
\shape italic
xmin_opt_init()
\shape default
 and 
\shape italic
lmod_opt_init()
\shape default
 just before the calls to 
\shape italic
xmin()
\shape default
 and 
\shape italic
lmod()
\shape default
.
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="39" columns="3">
<features islongtable="true" headBottomDL="true" longtabularalignment="center">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="3.5in">
<row endhead="true">
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
keyword
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
default
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
meaning
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
natm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of atoms.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
x[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Coordinate vector.
 User has to allocate memory in calling program and fill x[] with initial
 coordinates using, e.g., the setxyz_from_mol function (see sample program
 below).
 Array size = 3*natm.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
g[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gradient vector.
 User has to allocate memory in calling program.
 Array size = 3*natm.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ene
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
On output, ene stores the global minimum energy.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
conflib[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
User allocated storage array where LMOD stores low-energy conformations.
 Array size = 3*natm*nconf.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_traj[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
User allocated storage array where LMOD stores snapshots of the pseudo trajector
y drawn by LMOD on the potential energy surface.
 Array size = 3*natom * (nconf + 1).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lig_start[] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The serial number(s) of the first/last atom(s) of the ligand(s).
 The number(s) should correspond to the numbering in the NAB input files.
 Note that the ligand(s) can be anywhere in the atom list, however, a single
 ligand must have continuous numbering between the corresponding lig_start
 and lig_end values.
 The arrays should be allocated in the calling program.
 Array size = nlig, but in case nlig=0 there is no need for allocating memory.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lig_end[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
See above.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lig_cent[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Similar array in all respects to lig_start/end, but the serial number(s)
 define the center of rotation.
 The value zero means that the center of rotation will be the geometric
 center of gravity of the ligand.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
tr_min[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The range of random translation/rotation applied to individual ligand(s).
 Rotation is carried out about the origin defined by the corresponding lig_cent
 value(s).
 The angle is given in +/- degrees and the distance in angstroms.
 The particular angles and distances are randomly chosen from their respective
 ranges.
 The arrays should be allocated in the calling program.
 Array size = 
\shape italic
nlig
\shape default
, but in case 
\shape italic
nlig=0
\shape default
 there is no need to allocate memory.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
tr_max[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
See tr_min[], above.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
rot_min[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
See tr_min[], above.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
rot_max[]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
See tr_min[], above.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
niter
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The number of LMOD iterations.
 Note that a single LMOD iteration involves a number of different computations
 (see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

.).
 A value of zero results in a single local minimization; like a call to
 xmin.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nmod
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The total number of low-frequency modes computed by LMOD every time such
 computation is requested.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
minim_grms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The gradient RMS convergence criterion of structure minimization.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
kmod
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The definite number of randomly selected low-modes used to drive LMOD moves
 at each LMOD iteration step.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nrotran_dof
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The number of rotational and translational degrees of freedom.
 This is related to the number of frozen or tethered atoms in the system:
 0 atoms dof=6, 1 atom dof=3, 2 atoms dof=1, 
\begin_inset Formula $>$
\end_inset

=3 atoms dof=0.
 Default is 6, no frozen or tethered atoms.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod5"

\end_inset

, note (5).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nconf
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum number of low-energy conformations stored in conflib[].
 Note that the calling program is responsible for allocating memory for
 conflib[].
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
energy_window
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
50.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The energy window for conformation storage; the energy of a stored structure
 will be in the interval [global_min, global_min + energy_window].
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
eig_recalc
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The frequency, measured in LMOD iterations, of the recalculation of eigenvectors.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
ndim_arnoldi
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The dimension of the ARPACK Arnoldi factorization.
 The default, zero, specifies the whole space, that is, three times the
 number of atoms.
 See note below.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_restart
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The frequency, in LMOD iterations, of updating the conflib storage, that
 is, discarding structures outside the energy window, and restarting LMOD
 with a randomly chosen structure from the low-energy pool defined by n_best_str
uct below.
 A value 
\begin_inset Formula $>$
\end_inset

maxiter will prevent LMOD from doing any restarts.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
n_best_struct
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of the lowest-energy structures found so far at a particular LMOD
 restart point.
 The structure to be used for the restart will be chosen randomly from this
 pool.
 n_best_struct = 1 allows the user to explore the neighborhood of the then
 current global minimum.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
mc_option
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The Monte Carlo method.
\begin_inset Newline newline
\end_inset

1= Metropolis Monte Carlo (see rtemp below).
\begin_inset Newline newline
\end_inset

2= "Total_Quench", which means that the LMOD trajectory always proceeds
 towards the lowest lying neighbor of a particular energy well found after
 exhaustive search along all of the randomly selected kmod low-modes.
\begin_inset Newline newline
\end_inset

3= "Quick_Quench", which means that the LMOD trajectory proceeds towards
 the first neighbor found, which is lower in energy than the current point
 on the path, without exploring the remaining modes.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
rtemp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
1.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The value of RT in NAB energy units.
 This is utilized in the Metropolis criterion.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_step_size_min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The minimum length of a single LMOD ZIG move in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset

.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_step_size_max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
5.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The maximum length of a single LMOD ZIG move in 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
r{A}
\end_layout

\end_inset

.
 See section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nof_lmod_steps
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The number of LMOD ZIG-ZAG moves.
 The default, zero, means that the number of ZIG-ZAG moves is not pre-defined,
 instead LMOD will attempt to cross the barrier in as many ZIG-ZAG moves
 as it is necessary.
 The criterion of crossing an energy barrier is stated above in section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

.
 nof_lmod_steps 
\begin_inset Formula $>$
\end_inset

 0 means that multiple barriers may be crossed and LMOD can carry the molecule
 to a large distance on the potential energy surface without severely distorting
 the geometry.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_relax_grms
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The gradient RMS convergence criterion of structure relaxation, see ZAG
 move in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nlig
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Number of ligands considered for flexible docking.
 The default, zero, means no docking.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
apply_rigdock
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The frequency, measured in LMOD iterations, of the application of rigid-body
 rotational and translational motions to the ligand(s).
 At each apply_rigdock-th LMOD iteration nof_pose_to-try rotations and translati
ons are applied to the ligand(s).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
nof_poses_to_try
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The number of rigid-body rotational and translational motions applied to
 the ligand(s).
 Such applications occur at each apply_rigdock-th LMOD iteration.
 In case nof_pose_to_try 
\begin_inset Formula $>$
\end_inset

 1, it is always the lowest energy pose that is kept, all other poses are
 discarded.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
random_seed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
314159
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
The seed of the random number generator.
 A value of zero requests hardware seeding based on the system clock.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
print_level
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Amount of debugging printout.
 0= No output.
 1= Basic output.
 2= Detailed output.
 3= Copious debugging output including ARPACK details.
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
lmod_time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CPU time in seconds used by LMOD itself.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
aux_time
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CPU time in seconds used by auxiliary routines.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
error_flag
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
N/A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
A nonzero value indicates an error.
 In case of an error LMOD will always print a descriptive error message.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Notes on the 
\emph on
ndim_arnoldi
\emph default
 parameter: Basically, the ARPACK package used for the eigenvector calculations
 solves multiple "small" eigenvalue problems instead of a single "large"
 problem, which is the diagonalization of the three times the number of
 atoms by three times the number of atoms Hessian matrix.
 This parameter is the user specified dimension of the "small" problem.
 The allowed range is nmod + 1 
\begin_inset Formula $<$
\end_inset

= ndim_arnoldi 
\begin_inset Formula $<$
\end_inset

= 3*natm.
 The default means that the "small" problem and the "large" problem are
 identical.
 This is the preferred, i.e., fastest, calculation for small to medium size
 systems, because ARPACK is guaranteed to converge in a single iteration.
 The ARPACK calculation scales with three times the number of atoms times
 the Arnoldi dimension squared and, therefore, for larger molecules there
 is an optimal ndim_arnoldi much less than three times the number of atoms
 that converges much faster in multiple iterations (possibly thousands or
 tens of thousands of iterations).
 The key to good performance is to select ndim_arnoldi such that all the
 ARPACK storage fits in memory.
 For proteins, ndim_arnoldi =1000 is generally a good value, but often a
 very small 
\begin_inset Formula $\sim$
\end_inset

50-100 Arnoldi dimension provides the fastest net computational cost with
 very many iterations.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:lmod4"

\end_inset

Sample LMOD program
\end_layout

\begin_layout Standard
The following sample program, which is based on the test program tlmod.nab,
 reads a molecular structure from a PDB file, runs a short LMOD search,
 and saves the low-energy conformations in PDB files.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{lstlisting}[numbers=left,numberstyle=
\backslash
tiny]
\end_layout

\begin_layout Plain Layout

//   LMOD reverse communication external minimization package.
\end_layout

\begin_layout Plain Layout

//   Written by Istvan Kolossvary.
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

#include "xmin_opt.h"
\end_layout

\begin_layout Plain Layout

#include "lmod_opt.h"
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// M A I N  P R O G R A M  to carry out LMOD simulation on a molecule/complex:
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

struct xmin_opt xo;
\end_layout

\begin_layout Plain Layout

struct lmod_opt lo;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

molecule mol;
\end_layout

\begin_layout Plain Layout

int   natm;
\end_layout

\begin_layout Plain Layout

float energy;
\end_layout

\begin_layout Plain Layout

int lig_start[ dynamic ], lig_end[ dynamic ], lig_cent[ dynamic ];
\end_layout

\begin_layout Plain Layout

float xyz[ dynamic ], grad[ dynamic ], conflib[ dynamic ], lmod_trajectory[
 dynamic ];
\end_layout

\begin_layout Plain Layout

float tr_min[ dynamic ], tr_max[ dynamic ], rot_min[ dynamic ], rot_max[
 dynamic ];
\end_layout

\begin_layout Plain Layout

float glob_min_energy;
\end_layout

\begin_layout Plain Layout

point dummy;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    lmod_opt_init( lo, xo );   //  set up defaults
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    lo.niter          = 3;     //  non-default options are here
\end_layout

\begin_layout Plain Layout

    lo.mc_option      = 2;
\end_layout

\begin_layout Plain Layout

    lo.nof_lmod_steps = 5;
\end_layout

\begin_layout Plain Layout

    lo.random_seed    = 99;
\end_layout

\begin_layout Plain Layout

    lo.print_level    = 2;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    xo.ls_maxatmov    = 0.15;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    mol = getpdb( "trpcage.pdb" );
\end_layout

\begin_layout Plain Layout

    readparm( mol, "trpcage.top" );
\end_layout

\begin_layout Plain Layout

    natm = mol.natoms;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    allocate xyz[ 3*natm ]; allocate grad[ 3*natm ];
\end_layout

\begin_layout Plain Layout

    allocate conflib[ lo.nconf * 3*natm ];
\end_layout

\begin_layout Plain Layout

    allocate lmod_trajectory[ (lo.niter+1) * 3*natm ];
\end_layout

\begin_layout Plain Layout

    setxyz_from_mol( mol, NULL, xyz );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    mm_options( "ntpr=5000, gb=0, cut=999.0, nsnb=9999, diel=R ");
\end_layout

\begin_layout Plain Layout

    mme_init( mol, NULL, "::ZZZ", dummy, NULL );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    mme( xyz, grad, 1 );
\end_layout

\begin_layout Plain Layout

    glob_min_energy = lmod( natm, xyz, grad, energy,
\end_layout

\begin_layout Plain Layout

          conflib, lmod_trajectory, lig_start, lig_end, lig_cent,
\end_layout

\begin_layout Plain Layout

          tr_min, tr_max, rot_min, rot_max, xo, lo );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    printf( "
\backslash
nGlob.
 min.
 E         = %12.3lf kcal/mol
\backslash
n", glob_min_energy );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// E N D  M A I N
\end_layout

\begin_layout Plain Layout


\backslash
end{lstlisting}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The corresponding screen output should look similar to this.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{lstlisting}
\end_layout

\begin_layout Plain Layout

Reading parm file (trpcage.top)
\end_layout

\begin_layout Plain Layout

title:
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

      mm_options:  ntpr=5000
\end_layout

\begin_layout Plain Layout

      mm_options:  gb=0
\end_layout

\begin_layout Plain Layout

      mm_options:  cut=999.0
\end_layout

\begin_layout Plain Layout

      mm_options:  nsnb=9999
\end_layout

\begin_layout Plain Layout

      mm_options:  diel=R
\end_layout

\begin_layout Plain Layout

________________________________________________________________
\end_layout

\begin_layout Plain Layout

                  Low-Mode Simulation
\end_layout

\begin_layout Plain Layout

---------------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

     1    E =     -118.117 ( 0.054)  Rg =    5.440
\end_layout

\begin_layout Plain Layout

  1  / 6  E =     -89.2057 ( 0.090)  Rg =    2.625  rmsd=  8.240  p= 0.0000
\end_layout

\begin_layout Plain Layout

  1  / 8  E =      -51.682 ( 0.097)  Rg =    5.399  rmsd=  8.217  p= 0.0000
\end_layout

\begin_layout Plain Layout

  3  /12  E =     -120.978 ( 0.091)  Rg =    3.410  rmsd=  7.248  p= 1.0000
\end_layout

\begin_layout Plain Layout

  3  /10  E =     -106.292 ( 0.099)  Rg =    5.916  rmsd=  4.829  p= 0.0004
\end_layout

\begin_layout Plain Layout

  4  / 6  E =     -106.788 ( 0.095)  Rg =    4.802  rmsd=  3.391  p= 0.0005
\end_layout

\begin_layout Plain Layout

  4  / 3  E =     -111.501 ( 0.097)  Rg =    5.238  rmsd=  2.553  p= 0.0121
\end_layout

\begin_layout Plain Layout

---------------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

     2    E =     -120.978 ( 0.091)  Rg =    3.410
\end_layout

\begin_layout Plain Layout

  1  / 4  E =     -137.867 ( 0.097)  Rg =    2.842  rmsd=  5.581  p= 1.0000
\end_layout

\begin_layout Plain Layout

  1  / 9  E =     -130.025 ( 0.100)  Rg =    4.282  rmsd=  5.342  p= 1.0000
\end_layout

\begin_layout Plain Layout

  4  / 3  E =     -123.559 ( 0.089)  Rg =    3.451  rmsd=  1.285  p= 1.0000
\end_layout

\begin_layout Plain Layout

  4  / 4  E =     -107.253 ( 0.095)  Rg =    3.437  rmsd=  2.680  p= 0.0001
\end_layout

\begin_layout Plain Layout

  5  / 5  E =     -113.119 ( 0.096)  Rg =    3.136  rmsd=  2.074  p= 0.0053
\end_layout

\begin_layout Plain Layout

  5  / 4  E =       -134.1 ( 0.091)  Rg =    3.141  rmsd=  2.820  p= 1.0000
\end_layout

\begin_layout Plain Layout

---------------------------------------------------------------------------
\end_layout

\begin_layout Plain Layout

     3    E =     -130.025 ( 0.100)  Rg =    4.282
\end_layout

\begin_layout Plain Layout

  1  / 8  E =     -150.556 ( 0.093)  Rg =    3.347  rmsd=  5.287  p= 1.0000
\end_layout

\begin_layout Plain Layout

  1  / 4  E =     -123.738 ( 0.079)  Rg =    4.218  rmsd=  1.487  p= 0.0151
\end_layout

\begin_layout Plain Layout

  2  / 8  E =     -118.254 ( 0.095)  Rg =    3.093  rmsd=  5.296  p= 0.0004
\end_layout

\begin_layout Plain Layout

  2  / 7  E =     -115.027 ( 0.090)  Rg =    4.871  rmsd=  4.234  p= 0.0000
\end_layout

\begin_layout Plain Layout

  4  / 7  E =     -128.905 ( 0.099)  Rg =    4.171  rmsd=  2.113  p= 0.4739
\end_layout

\begin_layout Plain Layout

  4  /11  E =      -133.85 ( 0.099)  Rg =    3.290  rmsd=  4.464  p= 1.0000
\end_layout

\begin_layout Plain Layout

__________________________________________________
\end_layout

\begin_layout Plain Layout

 Full list:
\end_layout

\begin_layout Plain Layout

       1  E =     -150.556 / 1  Rg =    3.347
\end_layout

\begin_layout Plain Layout

       2  E =     -137.867 / 1  Rg =    2.842
\end_layout

\begin_layout Plain Layout

       3  E =       -134.1 / 1  Rg =    3.141
\end_layout

\begin_layout Plain Layout

       4  E =      -133.85 / 1  Rg =    3.290
\end_layout

\begin_layout Plain Layout

       5  E =     -130.025 / 1  Rg =    4.282
\end_layout

\begin_layout Plain Layout

       6  E =     -128.905 / 1  Rg =    4.171
\end_layout

\begin_layout Plain Layout

       7  E =     -123.738 / 1  Rg =    4.218
\end_layout

\begin_layout Plain Layout

       8  E =     -123.559 / 1  Rg =    3.451
\end_layout

\begin_layout Plain Layout

       9  E =     -120.978 / 1  Rg =    3.410
\end_layout

\begin_layout Plain Layout

      10  E =     -118.254 / 1  Rg =    3.093
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Glob.
 min.
 E         =     -150.556 kcal/mol
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{lstlisting}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first few lines come from 
\shape italic
mm_init()
\shape default
 and 
\shape italic
mme()
\shape default
.
 The screen output below the horizontal line originates from LMOD.
 Each LMOD-iteration is represented by a multi-line block of data numbered
 in the upper left corner by the iteration count.
 Within each block, the first line displays the energy and, in parentheses,
 the gradient RMS as well as the radius of gyration (assigning unit mass
 to each atom), of the current structure along the LMOD pseudo simulation-path.
 The successive lines within the block provide information about the LMOD
 ZIG-ZAG moves (see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

).
 The number of lines is equal to 2 times kmod (2x3 in this example).
 Each selected mode is explored in both directions, shown in two separate
 lines.
 The leftmost number is the serial number of the mode (randomly selected
 from the set of nmod modes) and the number after the slash character gives
 the number of ZIG-ZAG moves taken.
 This is followed by, respectively, the minimized energy and gradient RMS,
 the radius of gyration, the RMSD distance from the base structure, and
 the Boltzmann probability with respect to the energy of the base structure
 and rtemp, of the minimized structure at the end of the ZIG-ZAG path.
 Note that exploring the same mode along both directions can result in two
 quite different structures.
 Also note that the number of ZIG-ZAG moves required to cross the energy
 barrier (see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:lmod2"

\end_inset

) in different directions can vary quite a bit, too.
 Occasionally, an exclamation mark next to the energy (!E = ...) denotes a
 structure that could not be fully minimized.
\end_layout

\begin_layout Standard
After finishing all the computation within a block, the corresponding LMOD
 step is completed by selecting one of the ZIG-ZAG endpoint structures as
 the base structure of the next LMOD iteration.
 The selection is based on the 
\shape italic
mc_option
\shape default
 and the Boltzmann probability.
 The LMOD pseudo simulation-path is defined by the series of these 
\shape italic
mc_option
\shape default
-selected structures and it is stored in 
\shape italic
lmod_traj[]
\shape default
.
 Note that the sample program saves these structures in a multi- PDB disk
 file called 
\shape italic
lmod_trajectory.pdb
\shape default
.
 The final section of the screen output lists the nconf lowest energy structures
 found during the LMOD search.
 Note that some of the lowest energy structures are not necessarily included
 in the 
\shape italic
lmod_traj[]
\shape default
 list, as it depends on the 
\shape italic
mc_option
\shape default
 selection.
 The list displays the energy, the number of times a particular conformation
 was found (increasing numbers are somewhat indicative of a more complete
 search), and the radius of gyration.
 The glob.
 min.
 energy is printed from the sample NAB program, not from LMOD.
 The sample program in 
\emph on
$AMBERHOME/AmberTools/examples/nab/lmod_dock
\emph default
 shows how one could write the top ten low-energy structures in separate,
 numbered PDB files.
 
\end_layout

\begin_layout Standard
As a final note, it is instructive to be aware of a simple safeguard that
 LMOD applies .
 A copy of the 
\shape italic
conflib[]
\shape default
 array is saved periodically in a binary disk file called 
\shape italic
conflib.dat
\shape default
.
 Since LMOD searches might run for a long time, in case of a crash low-energy
 structures can be recovered from this file.
 The format of 
\shape italic
conflib.dat
\shape default
 is as follows.
 Each conformation is represented by 3 numbers (double energy, double radius
 of gyration, and int number of times found), followed by the double (x,
 y, z) coordinates of the atoms.
\end_layout

\begin_layout Subsection

\series bold
\begin_inset CommandInset label
LatexCommand label
name "subsec:lmod5"

\end_inset

Tricks of the trade of running LMOD searches
\end_layout

\begin_layout Enumerate
The AMBER atom types HO, HW, and ho all have zero van der Waals parameters
 in all of the AMBER (and some other) force fields.
 Corresponding Aij and Bij coefficients in the PRMTOP file are set to zero.
 This means there is no repulsive wall to prevent two oppositely charged
 atoms, one being of type HO, HW or ho, to fuse as a result of the ever
 decreasing electrostatic energy as they come closer and closer to each
 other.
 This potential problem is rarely manifest in molecular dynamics simulations,
 but it presents a nuisance when running LMOD searches.
 The problem is local minimization, especially "aggressive" TNCG minimization
 (XMIN xo.method=3) that can easily result in atom fusion.
 Therefore, before running an LMOD simulation, the PRMTOP file (let's call
 it prmtop.in) must be processed by running the script "lmodprmtop prmtop.in
 prmtop.out".
 This script will replace all the repulsive Aij coefficients set to zero
 in prmtop.in with a high value of 1e03 in prmtop.out in order to re-create
 the van der Waals wall.
 It is understood that this procedure is parameter fudging; however, note
 that the primary goal of using LMOD is the quick generation of approximate,
 low-energy structures that can be further refined by high-accuracy MD.
\end_layout

\begin_layout Enumerate
LMOD requires that the potential energy surface is continuous everywhere
 to a great degree.
 Therefore, always use a distance dependent dielectric constant in mm_options
 when running searches in vacuo, or use GB solvation (note that GB calculations
 will be slow), and always apply a large cut-off.
 It does make sense to run quick and dirty LMOD searches in vacuo to generate
 low-energy starting structures for MD runs.
 Note that the most likely symptom of discontinuities causing a problem
 is when your NAB program utilizing LMOD is grabbing CPU time, but the LMOD
 search does not seem to progress.
 This is the result of NaN's that often can be seen when print_level is
 set to 
\begin_inset Formula $>$
\end_inset

 0.
\end_layout

\begin_layout Enumerate
LMOD is NOT INTENDED to be used with explicit water models and periodic
 boundary conditions.
 Although explicit-water solvation representation is not recommended, LMOD
 docking can be readily used with crystallographic water molecules as ligands.
\end_layout

\begin_layout Enumerate
Conformations in the conflib and lmod_trajectory files can have very different
 orientations.
 One trick to keep them in a common orientation is to restrain the position
 of, e.g., a single benzene ring.
 This will ensure that the molecule cannot be translated or rotated as a
 whole.
 However, when applying this trick you should set nrotran_dof = 0.
\end_layout

\begin_layout Enumerate
A subset of the atoms of a molecular system can be frozen or tethered/restrained
 in NAB by two different methods.
 Atoms can either be frozen by using the first atom expression argument
 in 
\emph on
mme_init()
\emph default
 or restrained by using the second atom expression argument and the reference
 coordinate array in 
\emph on
mme_init()
\emph default
 along with the 
\emph on
wcons
\emph default
 option in mm_options.
 LMOD searches, especially docking calculations can be run much faster if
 parts of the molecular system can be frozen, because the effective degrees
 of freedom is determined by the size of the flexible part of the system.
 Application of frozen atoms means that a much smaller number of moving
 atoms are moving in the fixed, external potential of the frozen atoms.
 The tethered atom model is expected to give similar results to the frozen
 atom model, but note that the number of degrees of freedom and, therefore,
 the computational cost of a tethered calculation is comparable to that
 of a fully unrestrained system.
 However, the eigenvector calculations are likely to converge faster with
 the tethered systems.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:hcp"

\end_inset

The Generalized Born with Hierarchical Charge Partitioning (GB-HCP)
\end_layout

\begin_layout Standard
GB-HCP (and its latest version, GB-HCPO
\begin_inset CommandInset citation
LatexCommand citep
key "IzadiHCPO"
literal "true"

\end_inset

 ) is a multi-scale, yet fully atomistic, approach to perform MD simulations
 based on the generalized Born model, mainly intended for large and very
 large structures.
 For example, it was used to refine a 1.1M atom structure of 30nm chromatin
 fiber
\begin_inset CommandInset citation
LatexCommand citep
key "IzadiHCPO"
literal "true"

\end_inset

.
 Compared to the reference GB model without further approximations, GB-HCP
 can deliver up to 3 orders of magnitude speedup, depending on structure
 size.
 In contrast to cutoff GB that completely ignores the effect of long range
 electrostatic interactions beyond a certain distance, which can lead to
 serious artifacts under many circumstances such as for highly charged systems,
 GB-HCP takes into account the long range electrostatic interactions by
 using N log N Hierarchical Charge Partitioning (HCP) approximation 
\begin_inset CommandInset citation
LatexCommand citep
key "Anandakrishnan2010Nlogn,Anandakrishnan2011Nlogn"
literal "true"

\end_inset

.
 Based on this method, structures are partitioned into multiple hierarchical
 levels of components using the natural organization of the biomolecular
 structures - atoms, groups, chains, and complexes.
 The charge distribution for each of these components is approximated by
 1 (hcp=1) or 2 (hcp=2 and hcp=4) charges.
 Setting hcp=4 (strongly recommended) uses GB-HCPO, which takes advantage
 of the Optimal Point Charge Approximation approach for placing the approximate
 point charges
\begin_inset CommandInset citation
LatexCommand citep
key "Anandakrishnan13"
literal "true"

\end_inset

: two point charges are placed so that the three lowest order multipole
 moments of the reference charge distribution are optimally reproduced.
 The approximate charges are then used for computing electrostatic interactions
 with distant components while the full set of atomic charges are used for
 nearby components (Figure 40.1).
 The HCP can be used for generalized Born (gb=1-8) simulations, for gas
 phase (dielec=C) and distant dependent dielectric (dielec=R/RL), with or
 without Langevin dynamics (gamma_ln>0).
\end_layout

\begin_layout Standard
The usage of the new feature (hcp=4) requires that the separation between
 the two charges used to approximate the uncharged components is specified
 by dhcp.
 The value of dhcp is empirically adjusted so that the RMS error in force,
 compared to the GB without further approximation, is minimized.
 Our testing on a various set of structures suggests that dhcp=0.25 is optimal
 for many systems.
 However, if further accuracy is desired for specific systems, the value
 for dhcp can be further optimized within the range of 0.1 and 0.4 following
 the steps below.
 To find the optimal value for hcp, one time step simulation for the starting
 configuration of the structure can be performed using the GB model without
 approximation (hcp=0), and with e_debug=1setting, that automatically prints
 out the forces on each atom into a text file called reference.frc.
 Rename reference.frc to exact.frc.
 Then, run one step of the starting configuration of the structure using
 the GB-HCP (hcp=4) by setting the dhcp parameter within the range of 0.1
 and 0.4 in increments of 0.05.
 The reference.frc file produced for each value of dhcp can be compared to
 the exact.frc to compute the RMS error in force.
 The following command line computes the RMS error:
\end_layout

\begin_layout LyX-Code

\size footnotesize
paste exact.frc reference.frc | awk '{x+=($9-$20)^2+($10-$21)^2+($11-$22)^2}END{pr
int sqrt(x/NR)}'
\end_layout

\begin_layout Standard
The optimal value for dhcp is the one that results in minimum RMS error
 in the force.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fighcp"

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The HCP threshold distance.
 For the level 1 approximation shown here, groups within the threshold distance
 are treated exactly using atomic charges, while groups beyond the threshold
 distance are approximated by a small number of charges, e.g.
 1 charge for hcp=1 shown here.
\end_layout

\end_inset


\begin_inset Graphics
	filename illust_hcp.eps
	width 12cm

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Level 1 HCP approximation
\end_layout

\begin_layout Standard
The HCP option can now be used with one level of approximation (groups)
 using NAB molecular dynamics scripts.
 No additional manipulation of the input structure files is required for
 one level of approximation.
 For an example see AmberTools/examples/hcp/2trx.nab.
 The level 1 approximation is recommended for single domain and small (<
 10,000 atoms) multi-domain structures.
 Speedups of 2x-10x can be realized using the level 1 approximation, depending
 on structure size.
 
\end_layout

\begin_layout Subsection
Level 2 and 3 HCP approximation
\end_layout

\begin_layout Standard
For larger multi-domain structures higher levels of approximations (chains
 and complexes) can be used to achieve up to 3 orders of magnitude speedups,
 depending on structure size.
 The following additional steps are required to include information about
 these higher level components in the prmtop file.
 For an example see AmberTools/examples/hcp/1kx5.nab.
 A fully working example (including the MD run scripts) of a 3 level partitionin
g of a giant structure, one million atom chromatin fiber, can be found at
 http://people.cs.vt.edu/onufriev/software.php.
 
\end_layout

\begin_layout Enumerate
Ensure the pdb file identifies the higher level structures: Chains (level
 2) separated by TER, and Complexes (level 3) separated by REMARK END-OF-COMPLEX
: 
\begin_inset Newline newline
\end_inset

...
 
\begin_inset Newline newline
\end_inset

ATOM ...
 
\begin_inset Newline newline
\end_inset

TER (end of chain) 
\begin_inset Newline newline
\end_inset

ATOM ...
\begin_inset Newline newline
\end_inset

...
\begin_inset Newline newline
\end_inset

ATOM ...
\begin_inset Newline newline
\end_inset

TER (end of chain) 
\begin_inset Newline newline
\end_inset

REMARK END-OF-COMPLEX 
\begin_inset Newline newline
\end_inset

ATOM ...
\end_layout

\begin_layout Enumerate
Execute hcp_getpdb to generate prmtop entries for HCP: hcp_getpdb pdb-filename
 hcp-prmtop
\end_layout

\begin_layout Enumerate
Concatenate the HCP prmtop entries to the end of the standard prmtop file
 generated by LEaP: cat prmtop-file hcp-prmtop > new-prmtop
\end_layout

\begin_layout Enumerate
Use this new prmtop file in the NAB molecular dynamics scripts instead of
 the prmtop file generated by LEaP
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintAll"
bibfiles "nabc"
options "jacs"

\end_inset


\end_layout

\end_body
\end_document
