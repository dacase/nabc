#!/bin/csh -f

# The Mulliken charges in sustiva.mol2.save were generated by sqm;
# you may get different results if a different QM program is applied

../../../bin/antechamber -i sustiva.pdb -fi pdb -o sustiva_g2.mol2 -fo mol2 \
   -ek "qm_theory='AM1', grms_tol=0.002, tight_p_conv=1, scfconv=1.d-10, " \
   -at gaff2 -c bcc >& antechamber.out || goto error
../../../bin/parmchk2 -s 2 -i sustiva_g2.mol2 -f mol2 -o frcmod_g2 || goto error
../../../bin/tleap -s -f leap_g2.in > leap_g2.out

../../dacdif -a 5.5e-3 sustiva_g2.mol2.save sustiva_g2.mol2
../../dacdif frcmod_g2.save frcmod_g2
../../dacdif leap_g2.out.save leap_g2.out
../../dacdif -r 0.02 prmtop_g2.save prmtop_g2

/bin/rm -f ANTE* ATOMTYPE.INF BCCTYPE.INF FOR* NEWPDB.PDB PREP.INF \
      prmcrd  antechamber.out leap.log sqm.in sqm.pdb sqm.out
exit(0)

error:
echo "  ${0}:  Program error"
exit(1)
